# Amazon Ads Optimizer - TODO

## 核心功能

### 数据库与后端
- [x] 设计并实现数据库Schema（广告账号、广告活动、广告组、关键词、ASIN、绩效组等）
- [x] 实现广告数据CRUD API
- [x] 实现绩效组管理API
- [x] 实现竞价日志API
- [x] 实现优化设置API
- [x] 实现市场曲线建模算法

### 仪表盘与数据可视化
- [x] 监控仪表盘（核心KPI展示）
- [x] 趋势图表（转化、销售额、ACoS、ROAS）
- [x] 时间段对比分析
- [x] 绩效组概览卡片

### 绩效组管理
- [x] 创建/编辑/删除绩效组
- [x] 设置优化目标（目标ACoS、目标ROAS、每日花费上限、销售最大化）
- [x] 跨广告活动分组管理
- [x] 绩效组状态监控

### 竞价优化
- [x] 关键词出价优化（Broad/Phrase/Exact）
- [x] ASIN商品定位出价优化
- [x] 展示位置竞价调整（搜索顶部、商品详情页、其余位置）
- [x] 日内多次竞价（Intraday Bidding）
- [x] 市场曲线建模（出价-流量-转化关系）

### 竞价日志
- [x] 出价调整记录列表
- [x] 筛选和搜索功能
- [x] 调整原因说明
- [x] 导出日志功能

### 优化设置
- [x] 账号级别设置（转换值类型、转换值来源、日内竞价规则）
- [x] 广告活动级别设置（最高出价、继承配置）
- [x] 配置继承机制

### 数据导入
- [x] CSV/Excel文件上传
- [x] 亚马逊广告报告解析
- [x] 数据验证和错误处理
- [x] 批量导入进度显示

### 广告类型支持
- [x] Sponsored Products (SP) - 自动/手动广告
- [x] Sponsored Brands (SB) - 品牌推广
- [x] Sponsored Display (SD) - 展示型推广

## 视觉设计
- [x] 专业深色主题设计
- [x] 响应式布局
- [x] 数据图表样式优化

## 测试
- [x] 单元测试（竞价优化算法、路由结构、认证流程）
- [x] 示例数据生成脚本

## Amazon Advertising API 集成

### API研究
- [x] 研究Amazon Advertising API文档和权限要求
- [x] 了解API支持的广告类型和操作
- [x] 确定OAuth认证流程

### API集成开发
- [x] 实现Amazon API OAuth认证流程
- [x] 开发广告活动数据同步功能
- [x] 开发关键词和ASIN数据同步功能
- [x] 开发绩效报告数据同步功能
- [x] 实现自动出价调整API调用
- [x] 添加API调用日志和错误处理

### 测试和优化
- [x] 编写API集成单元测试
- [x] 测试数据同步准确性
- [x] 测试出价调整执行效果

## 广告自动化功能扩展（基于运营流程文档）

### P0 - 核心功能
- [x] N-Gram词根分析与批量降噪功能
- [x] 广告漏斗自动迁移系统（广泛→短语→精准）
- [x] 流量隔离与冲突检测系统
- [x] 智能竞价调整系统（爬坡、纠错、分时）

### P1 - 高优先级
- [x] 搜索词智能分类系统
- [x] 精准/短语匹配智能决策
- [x] 否词前置系统

### P2 - 中优先级
- [x] 半月纠错复盘系统
- [ ] 动态文案优化建议
- [ ] 广告活动健康度监控


## 界面优化与产品定位广告逻辑调整

### 界面布局优化
- [x] 优化仪表盘页面布局和视觉设计
- [x] 优化绩效组管理页面布局
- [x] 优化广告活动页面布局
- [x] 优化广告自动化页面布局
- [x] 优化竞价日志页面布局
- [x] 优化设置页面布局
- [x] 改进整体导航和用户体验

### 产品定位广告否定词逻辑调整
- [x] 更新数据库Schema区分广告组层级和活动层级否定词
- [x] 修改N-Gram分析逻辑，产品定位广告生成活动层级否定建议
- [x] 修改流量冲突检测逻辑，产品定位广告在活动层级处理
- [x] 更新前端界面显示否定词层级信息
- [x] 添加产品定位广告的特殊处理说明


## 新功能开发（第四阶段）

### 半月纠错复盘功能
- [x] 设计纠错复盘算法（检测归因延迟导致的错误调价）
- [x] 实现后端API接口
- [x] 创建纠错复盘前端页面
- [x] 生成纠错建议报告

### 广告活动健康度监控
- [x] 设计健康度指标体系（ACoS异常、点击率骤降、转化率下降等）
- [x] 实现异常检测算法
- [x] 创建健康度监控仪表盘
- [x] 实现预警通知功能

### 批量操作功能
- [x] 实现批量应用否定词建议
- [x] 实现批量应用出价调整
- [x] 添加批量操作确认和撤销机制
- [x] 优化批量操作的用户体验


## 新功能开发（第五阶段）

### 邮件/消息通知功能
- [x] 实现通知服务模块
- [x] 集成系统内置通知API
- [x] 健康度监控异常自动触发通知
- [x] 创建通知配置界面
- [x] 支持通知阈值设置

### 定时自动优化功能
- [x] 实现定时任务调度系统
- [x] 每日自动运行N-Gram分析
- [x] 每日自动运行智能竞价调整
- [x] 创建定时任务配置界面
- [x] 记录自动优化执行日志


## 新功能开发（第六阶段）

### 批量操作功能
- [x] 设计批量操作数据库表结构（批量任务记录、操作项明细）
- [x] 实现批量应用否定词建议API
- [x] 实现批量应用出价调整API
- [x] 添加批量操作确认机制
- [x] 实现批量操作撤销功能
- [x] 创建批量操作前端界面
- [x] 优化批量操作的用户体验
### 半月纠错复盘系统

- [x] 设计纠错复盘数据库表结构
- [x] 实现归因延迟检测算法
- [x] 实现错误调价识别逻辑
- [x] 生成纠错建议报告
- [x] 创建纠错复盘前端页面
- [x] 支持一键应用纠错建议


## 新功能开发（第七阶段）

### Amazon API多账号管理
- [x] 更新数据库Schema支持多账号存储
- [x] 添加店铺名称自定义字段
- [x] 实现多账号CRUD API
- [x] 支持账号切换功能
- [x] 更新Amazon API设置页面支持多账号管理
- [x] 添加账号列表展示和管理界面
- [x] 实现账号状态监控（连接状态、同步状态）


## 新功能开发（第八阶段）

### 账号全局切换器
- [x] 创建AccountSwitcher组件
- [x] 在DashboardLayout顶部导航栏集成切换器
- [x] 实现账号切换时的数据刷新逻辑
- [x] 添加当前账号状态指示器
- [x] 支持快捷键切换账号

### 跨账号数据汇总报表
- [x] 设计跨账号汇总数据结构
- [x] 实现后端汇总API（总花费、总销售额、平均ACoS等）
- [x] 创建汇总报表前端页面
- [x] 添加账号对比图表
- [x] 支持时间范围筛选

### 账号数据导入/导出
- [x] 实现账号配置导出API（JSON/CSV格式）
- [x] 实现账号配置批量导入API
- [x] 创建导入导出前端界面
- [x] 添加导入数据验证
- [x] 支持导入预览和确认


## 新功能开发（第九阶段）

### 账号权限管理
- [x] 设计团队成员和权限数据库表结构
- [x] 实现团队成员邀请和管理API
- [x] 实现店铺访问权限分配API
- [x] 添加权限验证中间件
- [x] 创建团队成员管理前端页面
- [x] 创建权限分配前端界面
- [x] 支持角色权限（管理员/编辑/只读）

### 数据报表定期邮件推送
- [x] 设计邮件推送配置数据库表结构
- [x] 实现邮件推送服务模块
- [x] 实现跨账号汇总报表生成
- [x] 创建定时邮件推送任务
- [x] 创建邮件推送设置前端页面
- [x] 支持自定义推送频率（每日/每周/每月）
- [x] 支持选择推送的报表类型


## 新功能开发（第十阶段）

### 操作审计日志
- [x] 设计审计日志数据库表结构
- [x] 实现审计日志记录服务
- [x] 在关键操作点集成审计日志
- [x] 实现审计日志查询API
- [x] 创建审计日志前端页面
- [x] 支持按操作类型/用户/时间筛选
- [x] 支持审计日志导出功能

### 团队协作通知
- [x] 设计协作通知配置数据库表结构
- [x] 实现协作通知服务模块
- [x] 定义重要操作触发规则
- [x] 实现通知发送逻辑
- [x] 创建协作通知设置前端页面
- [x] 支持通知渠道配置（应用内/邮件）
- [x] 支持自定义通知规则


## 新功能开发（第十一阶段）

### 广告活动预算智能分配与建议
- [x] 设计预算分配数据库表结构（分配记录、历史表现、目标设置）
- [x] 实现预算分配算法（基于ROAS、ACoS、转化率等指标）
- [x] 实现销售目标设置功能
- [x] 创建预算优化建议API
- [x] 实现预算分配模拟功能（预测效果）
- [x] 创建预算分配前端页面
- [x] 添加预算分配可视化图表
- [x] 支持一键应用预算建议
- [x] 记录预算调整历史


## 新功能开发（第十二阶段）

### Amazon Advertising API真实集成
- [x] 配置Amazon API客户端凭证（Client ID和Client Secret）
- [x] 实现OAuth授权URL生成（支持多地区endpoint）
- [x] 实现OAuth回调处理和Token交换
- [x] 实现Token刷新机制
- [x] 更新前端授权流程界面
- [x] 添加授权状态显示和管理
- [x] 测试完整的OAuth授权流程


## 新功能开发（第十三阶段）

### 预算消耗预警功能
- [x] 设计预算消耗监控数据库表结构
- [x] 实现预算消耗速度计算算法
- [x] 实现异常检测逻辑（过快/过慢消耗）
- [x] 集成通知服务发送预警
- [x] 创建预算预警配置前端界面
- [x] 支持自定义预警阈值

### 预算分配效果追踪报告
- [x] 设计效果追踪数据库表结构
- [x] 实现分配前后指标对比算法
- [x] 生成效果对比报告（ROAS、ACoS、转化率等）
- [x] 创建效果追踪报告前端页面
- [x] 支持报告导出功能

### 季节性预算调整建议
- [x] 设计季节性趋势数据库表结构
- [x] 实现历史数据季节性分析算法
- [x] 识别大促期间（Prime Day、黑五等）
- [x] 生成季节性预算调整建议
- [x] 创建季节性建议前端界面

### 广告数据自动同步
- [x] 设计数据同步任务数据库表结构
- [x] 实现广告活动数据拉取服务
- [x] 实现关键词和ASIN数据拉取服务
- [x] 实现绩效报告数据拉取服务
- [x] 创建同步任务配置前端界面
- [x] 添加同步状态监控

### API调用限流机制
- [x] 设计API调用日志和配额数据库表结构
- [x] 实现请求队列管理
- [x] 实现令牌桶限流算法
- [x] 添加API调用重试机制
- [x] 创建API使用统计前端界面


## 新功能开发（第十四阶段）

### 历史大促效果对比图表
- [x] 设计大促效果对比数据结构
- [x] 实现历史大促数据查询API
- [x] 创建大促效果对比图表组件
- [x] 在季节性建议页面集成图表
- [x] 支持多个大促活动对比

### 数据同步定时调度功能
- [x] 设计同步调度配置数据结构
- [x] 实现同步调度CRUD API
- [x] 创建定时调度配置前端界面
- [x] 实现调度任务执行逻辑
- [x] 添加调度状态监控


## 界面优化（第十五阶段）

### 侧边栏菜单优先级调整
- [x] 分析当前菜单结构和运营工作流程
- [x] 重新设计菜单分组和优先级顺序
- [x] 实现新的菜单布局
- [x] 优化菜单图标和标签

### 界面数据展示优先级调整
- [x] 优化仪表盘核心KPI展示顺序
- [x] 调整各页面数据展示优先级
- [x] 优化关键操作入口位置


### 定时调度执行历史记录
- [x] 设计执行历史数据库表结构
- [x] 实现执行历史记录API
- [x] 在DataSync页面添加执行历史Tab
- [x] 显示每次执行的详细信息（开始时间、结束时间、状态、同步记录数）

### 大促效果对比增加ROI指标
- [x] 在seasonalBudgetService中添加ROI计算
- [x] 更新API返回ROI数据
- [x] 在前端图表中展示ROI指标
- [x] 添加ROI趋势对比

### 调度失败自动重试和告警通知
- [x] 实现失败自动重试机制（最多3次）
- [x] 集成通知服务发送失败告警
- [x] 记录重试历史
- [x] 在前端显示重试状态


## 数据安全优化（第十六阶段）

### 排查人工数据输入模块
- [x] 识别所有CSV/Excel上传功能
- [x] 识别所有手动数据输入表单
- [x] 评估每个模块的错误风险等级
- [x] 确定可通过API替代的数据来源

### 移除或改造人工上传功能
- [x] 移除广告数据CSV导入功能（改为API同步）
- [x] 移除绩效数据手动上传功能
- [x] 保留必要的配置类数据输入（如目标设置）
- [x] 添加数据来源标识（API vs 手动）

### 增强API自动同步
- [x] 强制首次使用时进行API授权
- [x] 设置默认自动同步策略
- [x] 添加同步数据完整性校验
- [x] 实现数据冲突检测和告警

### 数据验证和安全机制
- [x] 添加关键操作二次确认
- [x] 实现数据变更审计追踪
- [x] 添加异常数据自动拦截
- [x] 创建数据回滚机制


## 用户体验优化（第十七阶段）

### 首次登录引导流程
- [x] 创建引导流程组件（Onboarding Wizard）
- [x] 检测用户是否首次登录
- [x] 引导步骤1：欢迎介绍系统功能
- [x] 引导步骤2：连接Amazon API授权
- [x] 引导步骤3：首次数据同步
- [x] 引导步骤4：完成设置确认
- [x] 保存引导完成状态

### API连接状态实时检测
- [x] 创建Token状态检测服务
- [x] 在Amazon API页面显示连接状态
- [x] 检测Token过期时间
- [x] Token即将过期时显示提醒
- [x] Token已过期时显示重新授权按钮
- [x] 添加自动刷新Token机制

### 关键操作确认弹窗
- [x] 创建通用确认弹窗组件
- [x] 预算调整操作添加确认弹窗
- [x] 竞价修改操作添加确认弹窗
- [x] 显示变更前后对比预览
- [x] 添加批量操作影响范围提示
- [x] 记录操作确认日志


## 用户体验优化（第十八阶段）

### 批量操作确认弹窗
- [x] 在批量操作页面集成OperationConfirmDialog组件
- [x] 批量暂停广告活动添加确认弹窗
- [x] 批量启用广告活动添加确认弹窗
- [x] 批量调整预算添加确认弹窗
- [x] 显示批量操作影响的广告活动列表

### 引导流程跳过和进度保存
- [x] 添加跳过当前步骤按钮
- [x] 添加稍后完成按钮
- [x] 保存引导进度到localStorage
- [x] 下次登录时恢复引导进度
- [x] 在设置页面添加重新开始引导入口

### 仪表盘API状态小组件
- [x] 创建API状态小组件组件
- [x] 显示API连接健康状态
- [x] 显示最近同步时间
- [x] Token过期时显示警告
- [x] 点击跳转到API设置页面


## 用户体验优化（第十九阶段）

### 批量操作历史记录功能
- [x] 设计批量操作历史数据库表结构
- [x] 实现批量操作历史记录API（创建、查询、详情）
- [x] 在BatchOperations页面添加历史记录Tab
- [x] 显示历史操作列表（时间、类型、状态、影响数量）
- [x] 实现操作详情查看功能（展示每个操作项的变更内容）
- [x] 支持按时间范围和操作类型筛选
- [x] 支持历史记录导出功能


## 侧边栏优化（第二十阶段）

### 侧边栏固定显示优化
- [x] 确保侧边栏在所有页面固定显示
- [x] 添加明显的“返回主界面/监控仪表盘”按钮
- [x] 优化菜单分组的展开/收起状态
- [x] 确保当前页面在菜单中高亮显示
- [x] 优化移动端侧边栏体验


## 广告活动页面优化（第二十一阶段）

### 广告活动类型筛选
- [x] 添加广告活动类型筛选标签（SP自动、SP手动、SB、SD等）
- [x] 点击类型标签直接筛选显示对应类型的广告活动
- [x] 保持筛选状态在页面刷新后不丢失

### 广告活动列表指标优化
- [x] 显示广告活动名称
- [x] 显示广告活动类型
- [x] 显示计费方式
- [x] 显示创建日期
- [x] 显示广告状态
- [x] 显示广告活动日预算
- [x] 显示广告活动当日花费
- [x] 显示曝光数
- [x] 显示点击数
- [x] 显示点击率
- [x] 显示广告活动累计花费
- [x] 显示广告活动日销售额
- [x] 显示广告活动累计销售额
- [x] 显示ACoS
- [x] 显示ROAS
- [x] 显示广告活动所属绩效组


## 广告活动列表功能增强（第二十二阶段）

### 列排序功能
- [x] 为所有指标列添加排序功能
- [x] 点击列标题切换升序/降序排列
- [x] 显示当前排序状态指示器（箭头图标）
- [x] 支持数值列和文本列的正确排序
- [x] 保持排序状态在筛选切换后不丢失

### 列显示/隐藏设置
- [x] 添加列设置下拉菜单
- [x] 支持勾选/取消显示各列
- [x] 保存列显示设置到localStorage
- [x] 提供"重置为默认"按钮

### 快捷操作按钮
- [x] 添加暂停/启用快捷按钮
- [x] 添加编辑预算快捷按钮
- [x] 操作前显示确认弹窗
- [x] 操作后自动刷新列表


## 广告活动AI摘要和Bug修复（第二十五阶段）

### Bug修复
- [x] 修复自动化页面audit_logs SQL查询错误

### AI摘要功能
- [ ] 实现后端AI摘要API（调用LLM生成活动表现摘要）
- [ ] 在广告活动详情页添加AI摘要卡片组件
- [ ] 显示核心表现和关键指标的智能分析


## 广告活动详情页完善（第二十六阶段）

### 数据结构
- [ ] 确认广告位置（Placement）数据表结构
- [ ] 确认搜索词（Search Terms）数据表结构
- [ ] 设计层级关系：活动 -> 广告组 -> 投放词/搜索词

### 后端API
- [ ] 实现获取广告位置表现数据API
- [ ] 实现获取广告组下投放词列表API
- [ ] 实现获取搜索词报告API
- [ ] 扩展广告活动详情API返回更多数据

### 前端页面
- [ ] 添加广告位置Tab展示不同位置的表现数据
- [ ] 完善广告组Tab，支持展开查看投放词
- [ ] 添加投放词Tab展示所有投放关键词
- [ ] 添加搜索词Tab展示客户搜索词报告
- [ ] 优化页面布局和交互体验


## 分时预算和分时竞价功能（第二十七阶段）

### 数据结构设计
- [x] 创建小时级绩效数据表（hourly_performance）存储每小时的点击、花费、销售数据
- [x] 创建分时预算规则表（dayparting_budget_rules）存储每周每天的预算分配比例
- [x] 创建分时竞价规则表（hourparting_bid_rules）存储每天每小时的出价调整倍数
- [x] 创建分时策略配置表（dayparting_strategies）存储策略配置

### 后端API
- [x] 实现获取小时级绩效数据API
- [x] 实现分析历史数据生成最优分时策略API
- [x] 实现保存/更新分时预算规则API
- [x] 实现保存/更新分时竞价规则API
- [x] 实现启用/禁用分时策略API

### 分析算法
- [x] 实现基于历史数据的每周每天表现分析
- [x] 实现基于历史数据的每天每小时表现分析
- [x] 计算最优预算分配比例（基于ROAS/ACoS）
- [x] 计算最优出价调整倍数（基于转化率和CPC）
- [x] 支持自定义目标ACoS/ROAS进行优化
- [x] 实现分时广告位置倾斜分析（搜索顶部/商品页面/其他位置）
- [x] 计算不同时段各广告位的最优出价调整比例

### 前端页面
- [ ] 创建分时策略管理页面
- [ ] 展示每周每天的预算分配热力图
- [ ] 展示每天每小时的出价调整热力图
- [ ] 支持手动调整分时规则
- [ ] 支持一键生成最优策略
- [ ] 显示策略预期效果预测

- [x] 支持数值列和文本列的正确排序
- [x] 保持排序状态在筛选切换后不丢失

### 列显示/隐藏设置
- [x] 添加列设置下拉菜单
- [x] 支持勾选/取消显示各列
- [x] 保存列显示设置到localStorage
- [x] 提供"重置为默认"按钮

### 快捷操作按钮
- [x] 添加暂停/启用快捷按钮
- [x] 添加编辑预算快捷按钮
- [x] 操作前显示确认弹窗
- [x] 操作后自动刷新列表


## 侧边栏导航修复（第二十四阶段）

### 缺少DashboardLayout的页面
- [x] BudgetTracking.tsx - 预算追踪页面
- [x] DataSync.tsx - 数据同步页面
- [x] SeasonalBudget.tsx - 季节性预算页面
- [x] BudgetAlerts.tsx - 预算预警页面


## 广告活动AI摘要和Bug修复（第二十五阶段）

### Bug修复
- [x] 修复自动化页面audit_logs SQL查询错误

### AI摘要功能
- [x] 实现后端AI摘要API（调用LLM生成活动表现摘要）
- [ ] 在广告活动详情页添加AI摘要卡片组件
- [ ] 显示核心表现和关键指标的智能分析


## 分时预算和分时竞价功能（第二十七阶段）

### 数据结构设计
- [x] 创建小时级绩效数据表（hourly_performance）存储每小时的点击、花费、销售数据
- [x] 创建分时预算规则表（dayparting_budget_rules）存储每周每天的预算分配比例
- [x] 创建分时竞价规则表（hourparting_bid_rules）存储每天每小时的出价调整倍数
- [x] 创建分时策略配置表（dayparting_strategies）存储策略配置

### 后端API
- [x] 实现获取小时级绩效数据API
- [x] 实现分析历史数据生成最优分时策略API
- [x] 实现保存/更新分时预算规则API
- [x] 实现保存/更新分时竞价规则API
- [x] 实现启用/禁用分时策略API

### 分析算法
- [x] 实现基于历史数据的每周每天表现分析
- [x] 实现基于历史数据的每天每小时表现分析
- [x] 计算最优预算分配比例（基于ROAS/ACoS）
- [x] 计算最优出价调整倍数（基于转化率和CPC）
- [x] 支持自定义目标ACoS/ROAS进行优化
- [x] 实现分时广告位置倾斜分析（搜索顶部/商品页面/其他位置）
- [x] 计算不同时段各广告位的最优出价调整比例

### 前端页面
- [x] 创建分时策略管理页面
- [x] 显示每周每天的表现热力图
- [x] 显示每天每小时的表现热力图
- [x] 支持手动调整预算分配比例
- [x] 支持手动调整出价倍数
- [x] 显示策略执行日志
- [x] 添加分时策略导航菜单


## 投放词快捷操作功能（第二十九阶段）

### 后端API
- [ ] 实现关键词出价更新API
- [ ] 实现关键词状态更新API（启用/暂停）
- [ ] 实现商品定向出价更新API
- [ ] 实现商品定向状态更新API

### 前端UI
- [ ] 在投放词列表添加操作列
- [ ] 添加编辑出价按钮和弹窗
- [ ] 添加启用/暂停切换按钮
- [ ] 添加操作确认弹窗
- [ ] 操作后自动刷新列表

- [x] 支持数值列和文本列的正确排序
- [x] 保持排序状态在筛选切换后不丢失

### 列显示/隐藏设置
- [x] 添加列设置下拉菜单
- [x] 支持勾选/取消显示各列
- [x] 保存列显示设置到localStorage
- [x] 提供"重置为默认"按钮

### 快捷操作按钮
- [x] 添加暂停/启用快捷按钮
- [x] 添加编辑预算快捷按钮
- [x] 操作前显示确认弹窗
- [x] 操作后自动刷新列表


## 广告活动详情页完善（第二十八阶段）- 已完成

### 后端API
- [x] 实现获取广告活动下属广告组API
- [x] 实现获取广告活动下属投放词API（关键词+商品定向）
- [x] 实现获取广告活动下属搜索词API
- [x] 实现获取广告活动历史绩效数据API

### 前端页面
- [x] 创建广告活动详情页组件
- [x] 添加概览Tab（核心指标卡片）
- [x] 添加广告组Tab（广告组列表）
- [x] 添加投放词Tab（关键词+商品定向列表）
- [x] 添加搜索词Tab（客户搜索词列表）
- [x] 添加关键词Tab（按销售额排序）
- [x] 实现点击广告活动名称跳转到详情页


## 投放词快捷操作功能（第二十九阶段）- 已完成

### 后端API
- [x] 实现关键词出价更新API
- [x] 实现关键词状态更新API（启用/暂停）
- [x] 实现商品定向出价更新API
- [x] 实现商品定向状态更新API

### 前端界面
- [x] 在投放词列表添加编辑出价按钮
- [x] 在投放词列表添加暂停/启用按钮
- [x] 实现编辑出价弹窗（显示当前出价、输入新出价）
- [x] 实现暂停/启用确认弹窗
- [x] 操作成功后自动刷新列表


### 投放词批量操作和筛选功能（第三十阶段）- 已完成
### 后端API
- [x] 更新投放词查询API支持订单数据返回
- [x] 实现批量更新出价API
- [x] 实现批量更新状态API（启用/暂停）
- [x] 支持多维度筛选参数（匹配方式、状态、出价范围、点击范围、花费范围、销售额范围、ACoS范围、ROAS范围、订单数范围）
### 前端界面
- [x] 在投放词列表添加订单数列
- [x] 添加全选/取消全选复选框
- [x] 添加单行选择复选框
- [x] 添加批量操作工具栏（选中N项后显示）
- [x] 实现批量启用功能
- [x] 实现批量暂停功能
- [x] 实现批量修改竞价功能（支持固定值、增加百分比、减少百分比）
- [x] 添加筛选面板组件
- [x] 支持按匹配方式筛选（广泛、短语、精准、商品定向）
- [x] 支持按状态筛选（启用、暂停）
- [x] 支持按出价范围筛选
- [x] 支持按点击范围筛选
- [x] 支持按花费范围筛选
- [x] 支持按销售额范围筛选
- [x] 支持按ACoS范围筛选
- [x] 支持按ROAS范围筛选
- [x] 支持按订单数范围筛选
- [x] 支持多维度组合筛选
- [x] 添加清除筛选按钮钮


### 投放词和搜索词模块优化（第三十一阶段）- 已完成
### 投放词模块优化
- [x] 添加点击率(CTR)数据列
- [x] 添加转化率(CVR)数据列
- [x] 调整列顺序：投放词→类型→匹配方式→状态→出价→展示→点击→点击率→花费→订单→销售额→转化率→ACoS→ROAS→操作
### 搜索词模块优化
- [x] 添加完整数据列：客户搜索词、源头投放词、匹配方式、展示、点击、点击率、花费、订单、销售额、转化率、ACoS、ROAS
- [x] 调整列顺序符合运营阅读习惯
- [x] 添加否定关键词功能（短语否定/精准否定）
- [x] 添加高价值搜索词迁移功能（开发中）
- [x] 添加多维度筛选功能（按ACoS、转化率、花费、订单等筛选）
### 搜索词分析核心功能
- [x] 支持筛选有价值但未在关注列表中的搜索词
- [x] 支持快速筛选高消耗0转化或低转化搜索词
- [x] 支持对低效搜索词进行短语否定或精准否定
- [x] 支持高价值搜索词迁移到指定广告组（开发中）告组


## 投## 投放词和搜索词高级功能（第三十二阶段）- 部分完成
### 投放词模块优化
- [x] 添加点击率(CTR)数据列
- [x] 添加转化率(CVR)数据列
- [x] 调整列顺序符合运营习惯
- [x] 添加点击率和转化率筛选条件
### 搜索词模块完善
- [x] 添加完整数据列：搜索词、源头投放词、匹配方式、展示、点击、点击率、花费、订单、销售额、转化率、ACoS、ROAS
- [x] 添加否定关键词功能（短语否定/精准否定）
- [x] 添加多维度筛选功能
- [x] 支持筛选高消耗0转化搜索词
- [x] 支持高价值搜索词迁移（开发中）
### 投放词趋势图
- [ ] 点击投放词查看历史表现趋势
- [ ] 展示点击、花费、ACoS随时间变化
### 筛选预设功能
- [ ] 支持保存常用筛选条件为预设
- [ ] 支持快速切换筛选预设
- [ ] 预设保存到localStorage


## 投放词模块优化（第三十三阶段）- 已完成

### 筛选项展示优化
- [x] 投放词列表筛选项默认展开显示
- [x] 保留筛选按钮用于切换显示/隐藏

### CPC数据列
- [x] 在投放词列表添加CPC（每次点击成本）数据列
- [x] CPC计算公式：花费/点击数
- [x] 在列顺序中合理放置CPC列（出价列后面）

### 批量出价调整功能增强
- [x] 新增"按CPC倍数设置"调整方式（出价=CPC×N倍）
- [x] 新增"按CPC百分比提高"调整方式
- [x] 新增"按CPC百分比降低"调整方式
- [x] 更新批量出价弹窗UI支持新的调整方式
- [x] 添加CPC调整方式说明提示


## AI智能分析一键执行功能（第三十四阶段）

### 后端API
- [ ] 设计一键执行优化建议的数据结构
- [ ] 实现投放词出价批量调整API
- [ ] 实现投放词状态批量变更API（启用/暂停）
- [ ] 实现搜索词批量否定API（词组否定/精准否定）
- [x] 添加执行日志记录

### 前端界面
- [ ] 在AI分析结果中为每条建议添加执行按钮
- [ ] 添加批量选择和一键执行所有建议功能
- [ ] 显示执行状态和结果反馈
- [ ] 添加执行确认弹窗（显示即将执行的操作详情）
- [ ] 支持撤销最近执行的操作


## AI智## AI智能分析一键执行与效果复盘功能（第三十四阶段）- 已完成
### 数据库设计
- [x] 创建AI优化执行记录表（执行时间、执行内容、执行状态）
- [x] 创建AI效果预测表（7天/14天/30天预测数据）
- [x] 创建AI优化复盘表（实际数据、预测数据、达成率）
### 后端API - 一键执行
- [x] 实现投放词出价批量调整API
- [x] 实现投放词状态批量变更API（启用/暂停）
- [x] 实现搜索词批量否定API（词组否定/精准否定）
- [x] 添加执行日志记录
### 后端API - 效果预估
- [x] 实现基于历史数据的效果预估算法
- [x] 预估7天、14天、30天后的花费变化
- [x] 预估7天、14天、30天后的销售额变化
- [x] 预估7天、14天、30天后的ACoS和ROAS变化
### 后端API - 复盘分析
- [x] 实现复盘数据采集（在预测时间节点自动采集实际数据）
- [x] 实现预测vs实际数据对比分析
- [x] 计算优化目标达成率
- [x] 生成复盘报告
### 前端界面 - AI分析模块增强
- [x] 在AI分析结果中为每条建议添加执行按钮
- [x] 添加批量选择和一键执行所有建议功能
- [x] 显示效果预估数据（7天/14天/30天预测）
- [x] 添加执行确认弹窗（显示即将执行的操作详情和预估效果）
### 前端界面 - AI优化执行记录与复盘页面
- [x] 创建AI优化执行历史列表页面
- [x] 显示每次执行的具体内容和时间
- [x] 创建复盘分析页面（预测vs实际对比）
- [x] 显示优化目标达成率图表
- [x] 支持按时间范围筛选执行记录


## 投放词历史趋势图功能（第三十五阶段）- 已完成

### 后端API
- [x] 设计历史数据查询API（支持按时间范围查询）
- [x] 实现关键词历史数据查询（点击、花费、销售额、ACoS、ROAS等）
- [x] 实现商品定向历史数据查询
- [x] 支持7天、14天、30天、60天时间范围

### 前端界面
- [x] 创建趋势图组件（使用Recharts）
- [x] 创建历史趋势弹窗
- [x] 展示点击趋势图
- [x] 展示花费趋势图
- [x] 展示ACoS趋势图
- [x] 展示ROAS趋势图
- [x] 支持时间范围切换
- [x] 在投放词列表中添加查看趋势入口（点击投放词名称即可查看）


## 广告优化中心界面设计（第三十六阶段）- 已完成

### 界面草图设计
- [x] 设计广告优化中心整体布局
- [x] 设计广告活动列表与投放词内嵌展开交互
- [x] 设计AI优化建议常驻面板
- [x] 设计搜索词Tab切换视图
- [x] 设计投放词历史趋势侧边面板
- [x] 创建详细的界面设计文档


## 搜索词批量转投放词功能（第三十七阶段）- 已完成

### 后端API
- [x] 实现批量添加投放关键词API
- [x] 支持选择目标广告组
- [x] 支持选择匹配方式（广泛/短语/精准）
- [x] 支持设置初始出价
- [x] 自动检查重复关键词并跳过

### 前端界面
- [x] 在搜索词列表添加批量选择功能（复选框+全选）
- [x] 添加"添加为投放词"批量操作按钮
- [x] 创建添加投放词弹窗（选择广告组、匹配方式、出价）
- [x] 显示选中搜索词预览
- [x] 显示操作结果反馈（成功/失败数量）


#### 智能优化系统架构重构（第三十八阶段）- 设计完成
### 核心理念转变
- [x] 从"人工操作为主、工具辅助"转变为"算法自主决策执行、人工仅做监督调整"
- [x] 将广告自动化、分时策略、批量操作、纠错复盘整合到广告管理功能中
### 算法自主决策引擎
- [x] 设计决策引擎核心架构
- [x] 设计数据采集与分析模块
- [x] 设计规则引擎与条件判断
- [x] 设计自动执行与反馈记录
- [x] 设计人工干预接口
### 广告位置智能倾斜（Adspert核心优势）
- [x] 设计Top of Search、Product Page、Rest of Search的表现分析
- [x] 设计最优位置出价比例计算算法
- [x] 设计位置倾斜自动调整流程
- [x] 设计位置表现可视化分析界面
### 功能整合
- [x] 设计分时策略整合到广告活动管理
- [x] 设计批量操作整合为自动触发规则
- [x] 设计纠错复盘整合为闭环反馈系统
- [x] 设计简化导航结构，减少功能分散
### 界面重构
- [x] 设计算法控制面板（启用/暂停/参数调整）
- [x] 设计自动化执行日志面板
- [x] 设计人工干预入口
- [x] 设计效果对比仪表盘
### 设计文档输出
- [x] 算法自主决策引擎架构文档
- [x] 广告位置智能倾斜设计文档
- [x] 整合系统架构设计文档仪表盘


## 执行频率控制优化（第三十九阶段）- 设计完成

### 时段分析策略（参考Adspert）
- [x] 将24小时分割为12个2小时时段进行数据分析
- [x] 每个时段独立计算转化率、ACoS、ROAS等指标
- [x] 基于时段数据进行智能调整决策

### 执行频率限制
- [x] 同一投放词24小时内最多调整**1次**出价
- [x] 同一广告活动24小时内最多调整**1次**预算
- [x] 位置倾斜比例每**2小时**最多调整**1次**
- [x] 批量操作每次最多影响**100个**投放词

### 频率控制机制
- [x] 设计调整冷却期记录机制
- [x] 设计频率限制校验逻辑
- [x] 设计超出限制时加入待执行队列
- [x] 设计频率限制配置界面


## 广告位置智能倾斜算法详细设计（第四十阶段）

### 评分算法设计
- [ ] 设计位置效率评分公式（综合ROAS、ACoS、CVR、CPC）
- [ ] 设计权重分配策略（根据优化目标动态调整权重）
- [ ] 设计数据置信度评估（基于点击量和花费判断数据可靠性）

### 倾斜比例计算
- [ ] 设计基于评分差异的倾斜比例计算公式
- [ ] 设计倾斜上下限约束（0%-200%）
- [ ] 设计渐进式调整策略（避免大幅波动）

### 调整决策逻辑
- [ ] 设计调整触发条件（评分差异阈值、数据量要求）
- [ ] 设计调整幅度控制（单次最大调整步长）
- [ ] 设计安全边界和异常保护机制

### 可视化草图
- [ ] 生成算法流程图
- [ ] 生成界面交互草图



## ## 核心功能实现（第四十一阶段）- 开发中
### 位置倾斜频率调整
- [x] 将位置倾斜调整频率从"每刘2次"改为"每2小时1次"
- [x] 更新设计文档中的频率配置
### 广告位置智能倾斜功能实现
- [x] 创建位置表现数据表（placement_performance）
- [ ] 创建位置调整历史表（placement_adjustments）
- [ ] 实现位置数据同步API
- [ ] 实现位置效率评分算法
- [ ] 实现最优倾斜比例计算
- [ ] 实现位置倾斜自动调整
- [ ] 创建位置倾斜管理前端页面
### 2小时时段数据采集
- [x] 创建时段表现数据表（hourly_performance）
- [ ] 实现2小时时段数据采集API
- [ ] 实现时段效率分析算法
### 广告优化中心界面重构
- [ ] 创建新的广告优化中心页面
- [ ] 实现广告活动列表展开/折叠投放词
- [ ] 集成AI优化建议常驻面板
- [ ] 集成位置智能倾斜面板
- [ ] 更新导航结构构



## Amazon API频率限制分析（第四十二阶段）- 已完成

### API限制研究
- [x] 查阅Amazon Advertising API官方文档
- [x] 分析初始限制（1 TPS, 8640 TPD）
- [x] 分析基于收入的动态限制调整机制
- [x] 了解不同API端点的限制差异

### 合规优化频率设计
- [x] 设计API调用预算分配（数据同步40%、出价调整25%、位置倾斜15%等）
- [x] 设计2小时时段分析策略（与Adspert一致）
- [x] 设计请求队列管理和限流机制
- [x] 设计429错误处理和重试策略

### 频率限制配置
- [x] 投放词出价：24小时1次/词
- [x] 预算调整：24小时1次/活动
- [x] 位置倾斜：2小时1次/活动（每日最多12次）
- [x] 批量操作：每次最多100个

### 文档输出
- [x] 创建Amazon API频率限制分析文档
- [x] 更新系统设计文档中的频率配置



## 广告位置智能倾斜功能（第二十五阶段）

### 后端服务开发
- [x] 创建placementOptimizationService.ts服务文件
- [x] 实现位置效率评分算法（综合ROAS、ACoS、CVR、CPC等指标）
- [x] 实现最优倾斜比例计算算法
- [x] 实现位置表现数据查询功能
- [x] 实现位置倾斜设置更新功能
- [x] 实现自动优化执行功能
- [x] 实现批量优化功能

### 后端API开发
- [x] 添加placement路由到routers.ts
- [x] 实现getPerformance API（获取位置表现数据）
- [x] 实现getSettings API（获取当前倾斜设置）
- [x] 实现generateSuggestions API（生成优化建议）
- [x] 实现applyAdjustments API（应用调整）
- [x] 实现optimizeCampaign API（一键优化）
- [x] 实现batchOptimize API（批量优化）
- [x] 实现getHistory API（获取调整历史）

### 前端页面开发
- [x] 创建PlacementOptimization.tsx页面
- [x] 实现账号和广告活动选择器
- [x] 实现位置表现概览卡片
- [x] 实现位置表现详情表格
- [x] 实现分析结果弹窗
- [x] 实现确认应用弹窗
- [x] 实现优化设置弹窗
- [x] 添加路由配置
- [x] 添加侧边栏菜单项

### 待完成功能
- [ ] 实现2小时时段数据采集服务
- [ ] 实现位置调整历史记录查询
- [ ] 添加位置表现趋势图表
- [ ] 集成到广告活动详情页


## Adspert核心算法整合（第二十六阶段）
### 数据库设计
- [x] 创建市场曲线模型表 (market_curve_models)
- [x] 创建决策树模型表 (decision_tree_models)
- [x] 创建关键词预测表 (keyword_predictions)
- [x] 创建竞价对象利润估算表 (bid_object_profit_estimates)
- [x] 创建优化建议表 (optimization_recommendations)
- [x] 创建出价表现历史表 (bid_performance_history)
### 市场曲线服务
- [x] 实现展现曲线建模（对数回归）
- [x] 实现点击率曲线建模
- [x] 实现利润曲线计算 (Profit = Clicks × (CVR × AOV - CPC))
- [x] 实现利润最大化出价点计算（黄金分割搜索）
- [x] 编写市场曲线服务单元测试 (17个测试通过)
### 决策树服务
- [x] 实现决策树构建算法（CART）
- [x] 实现决策树预测服务
- [x] 实现长尾关键词预测
- [x] 实现贝叶斯更新（结合历史数据）
- [x] 编写决策树服务单元测试 (18个测试通过)
### 高级位置优化服务
- [x] 整合市场曲线、决策树和利润计算
- [x] 实现竞价对象层面的利润估算
- [x] 实现较低位置调整策略（Adspert策略）
- [x] 实现综合优化建议生成
### 后端API更新
- [x] 添加 advancedPlacement 路由
- [x] 添加市场曲线查询API (buildMarketCurve)
- [x] 添加决策树训练API (trainDecisionTree)
- [x] 添加利润分析API (analyzePlacementProfit)
- [x] 添加优化建议API (getRecommendations, applyRecommendation)
### 前端界面升级
- [x] 创建 AdvancedPlacementOptimization 页面
- [x] 添加市场曲线可视化图表
- [x] 添加决策树预测结果展示
- [x] 添加利润估算展示
- [x] 添加优化建议详情展示
- [x] 添加侧边栏菜单项
- [x] 添加路由配置


## 优化功能整合到广告管理模块（第二十七阶段）

### 设计目标
- [ ] 将分散的优化功能整合到核心广告管理模块
- [ ] 实现"算法决策执行，人只监督"的架构
- [ ] 简化用户界面，减少复杂的独立功能页面

### 后端重构：统一自动优化引擎
- [ ] 创建UnifiedOptimizationEngine服务
- [ ] 整合广告自动化（N-Gram、漏斗迁移、流量隔离）
- [ ] 整合位置倾斜和高级位置优化算法
- [ ] 整合分时策略（Dayparting）
- [ ] 整合纠错复盘逻辑
- [ ] 实现统一的优化任务调度器
- [ ] 实现优化执行日志记录

### 广告活动页面整合
- [ ] 添加"自动优化状态"列显示当前优化状态
- [ ] 添加"最近优化"列显示最近的自动调整
- [ ] 添加活动详情中的优化监督面板
- [ ] 显示算法决策历史和执行结果
- [ ] 添加一键暂停/恢复自动优化开关

### 绩效组管理页面整合
- [ ] 添加组级别自动优化总开关
- [ ] 显示组内所有活动的优化状态汇总
- [ ] 添加组级别优化目标设置（ACoS/ROAS目标）
- [ ] 显示组级别优化效果统计

### 预算分配页面整合
- [ ] 整合智能预算自动调整功能
- [ ] 显示预算消耗预警状态
- [ ] 添加季节性预算建议展示
- [ ] 显示预算调整历史和效果

### 侧边栏菜单简化
- [ ] 移除独立的"广告自动化"菜单项
- [ ] 移除独立的"位置倾斜"菜单项
- [ ] 移除独立的"高级位置优化"菜单项
- [ ] 移除独立的"分时策略"菜单项
- [ ] 移除独立的"批量操作"菜单项
- [ ] 保留核心的监控和管理菜单
- [ ] 添加"优化引擎"状态指示器

### 测试验证
- [ ] 编写统一优化引擎单元测试
- [ ] 验证整合后的功能正常工作


## 功能整合完成更新

### 后端重构：统一自动优化引擎 - 已完成
- [x] 创建UnifiedOptimizationEngine服务 (unifiedOptimizationEngine.ts)
- [x] 整合竞价调整、位置倾斜、分时策略、否定词等优化类型
- [x] 实现多种执行模式 (full_auto, semi_auto, manual, disabled)
- [x] 添加 unifiedOptimization 路由到 routers.ts

### 广告活动页面整合 - 已完成
- [x] 添加"自动优化"列显示优化状态
- [x] 添加待执行决策和今日执行数量徽章
- [x] 更新页面副标题显示"算法自动决策执行，人只做监督"

### 绩效组管理页面整合 - 已完成
- [x] 添加自动优化引擎状态卡片
- [x] 添加执行模式显示 (半自动模式)
- [x] 添加今日执行和待审批统计
- [x] 添加自动优化开关

### 预算分配页面整合 - 已完成
- [x] 更新页面副标题显示"算法自动决策执行，人只做监督"

### 侧边栏菜单简化 - 已完成
- [x] 移除独立的优化功能页面 (广告自动化、位置倾斜、高级位置优化、分时策略、批量操作)
- [x] 添加"优化中心"统一入口
- [x] 保留纠错复盘和季节性建议作为独立功能

### 优化中心页面 - 已完成
- [x] 创建 OptimizationCenter.tsx 页面
- [x] 实现优化引擎状态概览
- [x] 实现优化类型统计卡片
- [x] 实现待审批决策列表
- [x] 实现引擎设置面板
- [x] 实现执行历史记录

### 单元测试 - 已完成
- [x] 编写统一优化引擎测试 (15个测试通过)
- [x] 测试利润最大化公式
- [x] 测试位置倾斜策略
- [x] 测试批量执行逻辑


## 利润最大化出价点实时显示功能（第二十八阶段）

### 后端API
- [x] 创建利润最大化出价点计算API (getCampaignOptimalBids)
- [x] 实现广告活动级别的最优出价点计算
- [x] 实现绩效组级别的最优出价点汇总 (getPerformanceGroupOptimalBids)
- [x] 添加实时计算缓存机制 (5分钟缓存)

### 广告活动页面
- [x] 添加“最优出价”列显示利润最大化出价点
- [x] 显示当前出价与最优出价的差距百分比
- [x] 添加出价调整建议指示器 (↑需提高/↓需降低)

### 绩效组管理页面
- [x] 添加组级别最优出价汇总卡片 (GroupOptimalBidCard)
- [x] 显示优化度评分、预估最大利润、已分析关键词数
- [x] 显示需提高/需降低的关键词数量和总体建议

### 测试
- [x] 编写利润最大化出价点计算单元测试 (15个测试通过)


## 一键采纳优化建议功能（第二十九阶段）

### 后端API
- [x] 创建应用单个广告活动最优出价API (applyCampaignOptimalBids)
- [x] 创建应用绩效组所有广告活动最优出价API (applyGroupOptimalBids)
- [x] 添加操作确认和风险提示机制
- [x] 记录出价调整结果和统计

### 广告活动页面
- [x] 在最优出价列添加“采纳”按钮
- [x] 添加确认对话框显示调整详情
- [x] 显示调整前后的对比（前10个关键词）
- [x] 显示汇总统计和预估利润提升

### 绩效组管理页面
- [x] 在利润最大化出价点卡片添加“一键采纳所有优化建议”按钮
- [x] 添加确认对话框显示组内所有广告活动调整明细
- [x] 显示预估利润提升和警告信息

### 测试
- [x] 编写一键采纳功能单元测试 (13个测试通过)


## 出价调整历史记录模块（第三十阶段）

### 数据库设计
- [x] 创建出价调整历史表 (bid_adjustment_history)
- [x] 设计字段：时间、广告活动、绩效组、关键词、调整前出价、调整后出价、调整原因等

### 后端API
- [x] 创建获取历史记录列表API (getBidAdjustmentHistory)
- [x] 创建获取统计数据API (getBidAdjustmentStats)
- [x] 支持按时间范围筛选
- [x] 支持按广告活动筛选
- [x] 支持按绩效组筛选
- [x] 支持按调整类型筛选
- [x] 支持分页查询

### 前端页面
- [x] 创建出价调整历史记录页面 (BidAdjustmentHistory.tsx)
- [x] 实现统计卡片（总调整次数、预估利润提升、平均出价变化、提高/降低次数）
- [x] 实现调整类型分布图
- [x] 实现时间范围选择器
- [x] 实现广告活动/绩效组/调整类型下拉筛选
- [x] 实现历史记录表格展示
- [x] 添加CSV导出功能
- [x] 添加分页导航
- [x] 添加侧边栏菜单项

### 历史记录写入
- [x] 在applyCampaignOptimalBids中记录历史
- [x] 在applyGroupOptimalBids中记录历史

### 测试
- [x] 编写历史记录功能单元测试 (24个测试通过)


## 出价回滚、效果追踪和批量导入功能（第三十一阶段）

### 已完成功能

### 出价回滚功能
- [x] 添加回滚API (rollbackBidAdjustment)
- [x] 在历史记录表格中添加"回滚"按钮
- [x] 添加回滚确认对话框
- [x] 更新历史记录状态为"已回滚"
- [x] 记录回滚操作到历史

### 出价调整效果追踪
- [x] 扩展bid_adjustment_history表添加效果追踪字段
- [x] 创建效果追踪定时任务
- [x] 添加7天/14天/30天实际表现数据记录
- [x] 在历史记录中显示预估vs实际效果对比
- [x] 添加效果追踪统计卡片

### 批量导入历史数据
- [x] 创建CSV导入API (importBidAdjustmentHistory)
- [x] 添加CSV文件上传组件
- [x] 实现CSV解析和验证
- [x] 添加导入预览和确认
- [x] 显示导入结果统计

### 测试
- [x] 编写回滚功能单元测试 (17个测试通过)
- [x] 编写效果追踪单元测试
- [x] 编写批量导入单元测试


## 效果追踪定时任务、报告和批量回滚功能（第三十二阶段）

### 效果追踪定时任务
- [x] 创建效果追踪定时任务服务
- [x] 自动识别需要追踪的历史记录（7天/14天/30天到期）
- [x] 自动收集关键词实际表现数据
- [x] 更新历史记录的效果追踪字段
- [x] 添加定时任务配置到调度系统

### 效果追踪报告
- [x] 设计效果追踪报告数据结构
- [x] 实现报告生成API
- [x] 计算预估vs实际效果对比
- [x] 评估算法准确性指标
- [x] 创建效果追踪报告前端页面
- [x] 支持报告导出功能

### 批量回滚功能
- [x] 创建批量回滚API (batchRollbackBidAdjustments)
- [x] 在历史记录表格添加多选功能
- [x] 添加批量回滚按钮
- [x] 添加批量回滚确认对话框
- [x] 显示批量回滚影响范围

### 测试
- [x] 编写效果追踪定时任务单元测试
- [x] 编写效果追踪报告单元测试
- [x] 编写批量回滚功能单元测试

## 自动回滚规则和算法优化建议功能（第三十三阶段）
### 自动回滚规则
- [x] 设计自动回滚规则数据结构
- [x] 创建回滚规则配置表（阈值、触发条件）
- [x] 实现回滚规则评估服务
- [x] 实现自动回滚建议生成
- [x] 添加回滚建议通知功能
- [x] 创建回滚规则配置页面
- [x] 显示待回滚建议列表
### 算法优化建议
- [x] 设计算法优化建议数据结构
- [x] 实现历史准确率分析服务
- [x] 实现算法参数调优建议生成
- [x] 按调整类型分析准确率
- [x] 按出价变化幅度分析准确率
- [x] 创建算法优化建议页面
- [x] 显示优化建议详情和操作
### 测试
- [x] 编写自动回滚规则单元测试
- [x] 编写算法优化建议单元测试

## 绩效组智能预算分配优化（第三十四阶段）
### 研究与设计
- [x] 研究Adspert后台功能和优化逻辑
- [x] 梳理智能预算分配算法核心逻辑
- [x] 设计绩效组智能预算分配数据结构

### 后端服务
- [x] 实现广告活动数据聚合分析服务
- [x] 实现智能预算分配算法（基于出单数、投产比、花费）
- [x] 实现渐进式预算调整策略（避免大幅波动）
- [x] 实现预算分配建议生成服务
- [x] 添加预算分配历史记录

### 前端页面
- [x] 优化绩效组管理页面，展示智能预算分配建议
- [x] 添加预算分配可视化图表
- [x] 实现一键应用预算建议功能
- [x] 添加预算调整历史查看

### 测试
- [x] 编写智能预算分配算法单元测试
- [x] 编写预算分配服务单元测试


## 超越Adspert的智能预算分配系统（第三十四阶段-增强版）

### 创新算法设计
- [x] 多时间窗口分析（7天趋势+14天稳定性+30天基准）
- [x] 边际效益分析模型（找到最优预算点）
- [x] 季节性因素和竞争环境变化考量
- [x] 多元化优化目标支持（利润最大化、市场份额扩张、新品推广）

### 多维度评分引擎
- [x] 转化效率评分（转化数/花费，考虑趋势变化）
- [x] ROAS评分（相对于绩效组平均值）
- [x] 增长潜力评分（预算利用率+边际效益）
- [x] 稳定性评分（指标波动程度）
- [x] 趋势评分（近期表现趋势）

### 预测模型
- [x] 基于历史数据的预算-效果曲线建模
- [x] 边际效益递减点识别
- [x] 预算调整效果预测
- [x] 场景模拟功能（不同预算下的预期效果）

### 风险控制机制
- [x] 异常数据自动检测和过滤
- [x] 多层保护机制（单次调整上限、最小预算保护）
- [x] 冷却期机制（避免频繁调整）
- [x] 新广告活动保护期
- [x] 总预算守恒约束

### 智能决策解释
- [x] 详细的调整理由生成
- [x] 数据支撑可视化
- [x] 预期影响展示
- [x] 风险提示

### 前端界面
- [x] 智能预算分配配置页面
- [x] 预算分配建议列表
- [x] 场景模拟可视化
- [x] 效果追踪报告
- [x] 一键应用和批量操作

### 测试
- [x] 多维度评分引擎单元测试
- [x] 预测模型单元测试
- [x] 风险控制机制单元测试
- [x] 端到端集成测试


## Bug修复（第三十五阶段）
### 绩效组页面API错误
- [x] 修复db.getPerformanceGroupCampaigns函数不存在的问题
- [x] 验证绩效组页面正常加载


## A/B测试和预算自动执行功能（第三十六阶段）
### A/B测试功能
- [x] 设计A/B测试数据库表结构（测试组、对照组、指标记录）
- [x] 实现A/B测试创建和管理API
- [x] 实现测试组分配算法
- [x] 实现效果对比分析服务
- [x] 创建A/B测试配置前端页面
- [x] 创建测试结果分析页面

### 预算分配自动执行
- [x] 设计自动执行配置数据结构
- [x] 实现预算分配定时任务服务
- [x] 实现自动应用预算建议逻辑
- [x] 添加执行日志记录
- [x] 创建自动执行配置前端界面
- [x] 添加执行历史查看功能

### 测试
- [x] 编写A/B测试功能单元测试
- [x] 编写预算自动执行单元测试


## A/B测试结果可视化图表（第三十七阶段）
### 图表设计
- [x] 设计指标对比柱状图（ROAS、ACoS、转化率等）
- [x] 设计趋势对比折线图（每日指标变化）
- [x] 设计统计显著性可视化（置信区间、p值）
- [x] 设计效果提升百分比展示

### 实现
- [x] 创建ABTestCharts组件
- [x] 集成到ABTest页面
- [x] 添加图表交互功能（悬停提示、缩放）


## Bug修复和预算分配功能分析（第三十八阶段）
### Bug修复
- [x] 修复db.getKeywordsByCampaignId函数不存在的问题

### 预算分配功能分析
- [x] 分析现有预算分配功能代码结构
- [x] 评估功能价值和重复性
- [x] 决定整合或移除方案（已移除旧版预算分配入口，重定向到智能预算分配）


## Bug修复和预算分配功能分析（第三十八阶段）
### Bug修复
- [x] 修复db.getKeywordsByCampaignId函数不存在的问题

### 预算分配功能分析
- [x] 分析现有预算分配功能代码结构
- [x] 评估功能价值和重复性
- [x] 决定整合或移除方案（已移除旧版预算分配入口，重定向到智能预算分配）


## Bug修复（第三十九阶段）
### 广告活动页面market_curve_models查询错误
- [ ] 检查market_curve_models表是否存在
- [ ] 修复查询错误或创建缺失的表


## 全面功能测试和Bug修复（第四十阶段）
### 测试计划
- [ ] 梳理所有功能模块和页面路由
- [ ] 逐一测试每个页面
- [ ] 记录所有发现的错误
- [ ] 批量修复所有错误
- [ ] 验证修复结果

## 功能整合简化（极简化设计）- 第四十一阶段

### 侧边栏菜单整合
- [x] 删除"自动化任务"分组（定时任务、数据同步）
- [x] 简化"智能优化"分组（删除预算自动执行、自动回滚规则、算法优化建议、A/B测试）
- [x] 将智能预算分配整合到优化中心

### 页面整合
- [ ] 将数据同步功能整合到Amazon API设置页面
- [ ] 将自动执行、回滚规则、算法参数整合到优化设置页面

### 路由重定向
- [x] /scheduler 重定向到 /dashboard
- [x] /data-sync 重定向到 /amazon-api
- [x] /budget-auto-execution 重定向到 /settings
- [x] /auto-rollback 重定向到 /settings
- [x] /algorithm-optimization 重定向到 /settings
- [x] /ab-test 重定向到 /optimization-center
- [x] /intelligent-budget 重定向到 /optimization-center

### 仪表盘增强
- [ ] 在仪表盘添加自动化任务状态卡片
- [ ] 显示数据同步状态
- [ ] 显示自动优化执行状态

### 后台自动化
- [ ] 确保数据同步每2小时自动运行
- [ ] 确保智能竞价每天自动运行
- [ ] 确保健康度检查每天自动运行
- [ ] 确保效果追踪自动收集数据

## Bug修复 - 第四十二阶段

### 效果追踪报告页面错误修复
- [x] 修复campaigns.list路由不存在错误（改为campaign.list）
- [x] 修复performanceGroups.list路由不存在错误（改为performanceGroup.list）
- [x] 修复eq is not defined错误（添加drizzle-orm导入）
- [x] 修复isRolledBack字段不存在错误（改用status字段）
- [x] 修复adjustedAt字段不存在错误（改为appliedAt）
- [x] 修复数据库实例获取方式（使用db.getDb()）

### 审计日志页面日期格式错误修复
- [x] 修复getUserAuditStats函数中的日期比较（Date对象转ISO字符串）
- [x] 修复getAuditLogs函数中的日期比较
- [x] 修复getAccountAuditStats函数中的日期比较

## 绩效组管理和广告活动功能优化

### 第一阶段：研究Adspert逻辑
- [x] 研究Adspert的广告活动导入和分类逻辑
- [x] 研究Adspert的绩效组管理逻辑
- [x] 分析活跃/暂停/已介入/未介入的状态划分

### 第二阶段：设计方案
- [x] 设计广告活动自动导入流程
- [x] 设计广告活动状态分类系统
- [x] 设计绩效组与广告活动的关联逻辑

### 第三阶段：实施广告活动管理优化
- [ ] 实现广告活动自动导入功能
- [ ] 实现广告活动状态分类（活跃/暂停/已介入/未介入）
- [ ] 优化广告活动列表界面

### 第四阶段：实施绩效组管理优化
- [ ] 优化绩效组创建和编辑流程
- [ ] 实现绩效组与广告活动的关联管理
- [ ] 优化绩效组列表界面

## 绩效组管理优化（基于Adspert研究）

- [ ] 重构绩效组详情页，添加广告活动管理功能
  - [ ] 创建绩效组详情页面组件
  - [ ] 添加广告活动列表展示（双列选择器）
  - [ ] 实现添加/移除广告活动功能
  - [ ] 显示绩效组KPI汇总
- [ ] 改进优化目标设置界面
  - [ ] 添加优化大类选择（销售额/vCPM）
  - [ ] 优化目标类型选择（销售最大化/转化成本/ACoS/ROAS）
  - [ ] 添加每日费用上限和最高出价设置
- [ ] 添加场景模拟预测功能（基础版）
  - [ ] 基于历史数据预测花费-销售额关系
  - [ ] 显示预测指标卡片
- [ ] 添加未优化广告提醒
  - [ ] 在绩效组列表页顶部显示未介入优化的广告数量

## 绩效组管理优化完成情况

- [x] 创建绩效组详情页面 (/performance-groups/:id)
- [x] 添加KPI概览卡片（30天花费、销售额、ACoS、ROAS）
- [x] 添加Tab切换（概览、广告活动、场景模拟）
- [x] 实现广告活动管理功能（双列选择器）
- [x] 实现优化目标设置弹窗（4种目标类型）
- [x] 添加场景模拟预测界面（基础版）
- [x] 在绩效组列表页添加"管理"按钮跳转到详情页
- [x] 添加API支持（getById, getCampaigns, getKpiSummary, addCampaigns, removeCampaign, updateGoal）

## Bug修复记录

- [x] 修复campaigns表optimization_status列名不匹配问题（下划线改为驼峰命名）
- [x] 修复market_curve_models表schema列名映射问题（移除显式下划线命名）

## 广告管理模块重构

- [ ] 重构优化目标模块（原绩效组管理）
  - [ ] 实现筛选条件创建优化目标（店铺、广告活动名、类型、转化次数等）
  - [ ] 设定日预算目标和最高竞价上限
  - [ ] 显示优化目标下的广告活动列表
- [ ] 优化广告活动列表模块
  - [ ] 显示所有从Amazon导入的广告活动
  - [ ] 显示广告活动的优化状态（已介入/未介入）
- [ ] 更新侧边栏菜单结构（广告管理 → 优化目标 + 广告活动）

## 广告活动筛选功能修复

- [x] 修复优化目标页面的广告类型筛选（SP/SB/SD与数据库值不匹配）
- [x] 修复优化目标页面的运行状态筛选
- [x] 广告活动列表页面的类型筛选已正常工作（使用数据库实际值）
- [x] 广告活动列表页面的状态筛选已正常工作
- [x] 测试验证所有筛选功能正常工作

## 筛选功能优化

- [x] 优化多条件联合筛选逻辑（广告类型+运行状态+数值条件组合）
- [x] 在优化目标创建向导中显示筛选结果统计（各类型数量、各状态数量）
- [x] 显示筛选条件变化时的实时统计更新

## Stripe 支付功能集成

- [x] 使用 webdev_add_feature 添加 Stripe 集成
- [ ] 配置 Stripe API 密钥（STRIPE_SECRET_KEY, STRIPE_PUBLISHABLE_KEY）
- [ ] 创建订阅计划和产品定价页面
- [ ] 实现支付结账流程
- [ ] 实现订阅管理功能
- [ ] 添加 Webhook 处理支付事件
- [ ] 测试支付流程

## 优化算法复盘与对比分析

- [ ] 分析当前系统中的优化算法实现
- [ ] 研究Adspert的广告优化算法
- [ ] 对比分析并总结优势和不足
- [ ] 检查算法在各模块的实际应用情况
- [ ] 优化后台功能确保算法有效应用
- [ ] 输出复盘报告


## 优化算法复盘与对比分析（第二十三阶段）

- [x] 分析当前系统中的优化算法实现
- [x] 研究Adspert的广告优化算法
- [x] 对比分析并总结优势和不足
- [x] 检查算法在各模块的实际应用情况
- [x] 输出复盘报告 (docs/algorithm-review-report.md)

### 发现的问题
- [ ] 修复db.ts中重复的getAllCampaigns导出错误
- [ ] 修复TypeScript类型错误（dailyPerformance.date类型不匹配）


## 算法优化功能（第二十四阶段）

### 情景模拟功能
- [ ] 在智能预算分配页面添加预算-效果预测图表
- [ ] 实现多场景对比功能（保守/平衡/激进）
- [ ] 显示预测的销售额、ROAS、ACoS变化
- [ ] 添加滑块交互调整预算

### 决策树模型
- [ ] 设计决策树模型数据结构
- [ ] 实现CTR预测模型
- [ ] 实现CVR预测模型
- [ ] 实现转化价值预测模型
- [ ] 集成到出价优化算法中

### 市场曲线可视化
- [ ] 在关键词详情页添加出价-效果曲线图
- [ ] 标注当前出价点
- [ ] 标注建议出价点
- [ ] 显示边际收益/边际成本曲线
- [ ] 添加交互式出价模拟


## 优化算法完整性审计（第二十五阶段）

### 算法需求梳理
- [x] 广告活动预算优化算法 - 已实现 (intelligentBudgetAllocationService)
- [x] 广告位置调整算法 - 已实现 (placementOptimizationService)
- [x] 投放词竞价调整算法 - 已实现 (bidOptimizer)
- [x] 投放词暂停/启用自动化规则 - 部分实现 (adAutomation)
- [x] 搜索词相关性和成交识别算法 - 已实现 (adAutomation.classifySearchTerms)
- [x] 搜索词迁移再投放算法 - 已实现 (adAutomation.analyzeFunnelMigration)
- [x] 分时竞价调整算法 - 已实现 (daypartingService)
- [x] 分时预算分配算法 - 部分实现 (daypartingService)

### 算法应用检查
- [x] 检查各算法模块的实现状态
- [x] 分析算法在系统各模块的应用情况
- [x] 识别算法缺失和应用不足的问题
- [x] 输出完整的算法审计报告 (docs/algorithm-audit-report.md)


## 算法优化功能实现（第二十六阶段）

### 投放词自动执行机制
- [ ] 设计自动执行配置数据库表结构
- [ ] 实现自动暂停规则引擎（高花费低转化检测）
- [ ] 实现安全阈值配置功能
- [ ] 实现自动执行回滚机制
- [ ] 创建自动执行配置前端界面
- [ ] 添加自动执行日志记录

### 分时预算分配集成到优化目标
- [ ] 在优化目标数据库表中添加分时预算配置字段
- [ ] 实现优化目标启动时自动开始分时分析
- [ ] 实现基于历史数据的自动时段预算分配
- [ ] 实现定时自动执行预算调整
- [ ] 异常时自动通知（无需人工参与）

### 市场曲线可视化完善
- [ ] 完善BidResponseCurve组件交互功能
- [ ] 添加当前出价点标注
- [ ] 添加建议出价点标注
- [ ] 实现交互式出价滑块
- [ ] 显示边际收益/边际成本曲线



## 优化目标模块重构（第二十三阶段）

### 核心理念
- 优化目标作为所有优化算法的统一执行入口
- 广告活动页面仅作为数据展示层
- 优化目标启用后自动执行所有优化策略

### 任务清单
- [ ] 分析当前优化目标模块的结构和功能
- [ ] 设计优化目标自动执行引擎架构
- [ ] 实现优化目标自动执行服务（集成所有算法）
  - [ ] 广告活动位置百分比调整
  - [ ] 投放词分时竞价
  - [ ] 客户搜索词分析和处理
  - [ ] 预算分配优化
  - [ ] 投放词暂停/启用决策
- [ ] 更新优化目标前端界面（显示自动执行状态）
- [ ] 简化广告活动页面（仅保留数据展示和基础操作）
- [ ] 测试验证自动优化功能


## Bug修复（第二十八阶段）

### 执行优化按钮修复
- [x] 诊断"执行优化"按钮点击无响应问题
- [x] 修复后端isEnabled字段检查逻辑（使用status字段替代不存在的isEnabled字段）
- [x] 验证executeOptimization API正常工作
- [x] 测试前端按钮点击触发优化执行


### 优化目标关联广告活动
- [ ] 查询当前广告活动和优化目标数据
- [ ] 将广告活动关联到对应的优化目标
- [ ] 测试执行优化功能，验证出价调整



## 优化算法整合（第二十九阶段）

### 算法文档整合
- [ ] 更新算法总结文档，整合完整优化体系
- [ ] 整合预算控制算法
- [ ] 整合分时预算算法
- [ ] 整合投放词竞价控制算法
- [ ] 整合分时竞价算法
- [ ] 整合广告活动位置倾向算法
- [ ] 整合客户搜索词判断算法

### N-Gram算法优化
- [ ] 调整N-Gram阈值（频率25次、花费$12.5）
- [ ] 实现核心投放词根排除机制
- [ ] 避免过度否词导致丧失核心用户

### 否词迁移人工审核功能
- [ ] 设计人工审核界面
- [ ] 实现数据梳理和反馈展示
- [ ] 支持一键审批全部否定
- [ ] 支持一键拒绝全部否定
- [ ] 支持批量选择操作（部分接受/部分拒绝）


### 自动执行安全边界
- [ ] 预算控制改为自动执行，设置±25%安全边界（基于近7天平均花费，排除最近2天）
- [ ] 竞价控制改为自动执行，设置±10%安全边界（基于近7天平均CPC，排除最近2天）
- [ ] 位置倾向改为自动执行，设置±25%安全边界（基于近7天设定数据，排除最近2天），上限200%

- [ ] 分时预算时段划分改为每2小时一个时段（共12个时段）

## 算法实现（第三十阶段）

### 安全边界模块
- [ ] 实现预算安全边界计算（±25%）
- [ ] 实现竞价安全边界计算（±10%）
- [ ] 实现位置安全边界计算（±25%，上限200%）
- [ ] 实现近7天平均值计算（排除最近2天）

### 分时预算算法
- [ ] 实现12时段划分逻辑
- [ ] 实现时段表现分析
- [ ] 实现分时预算调整算法

### N-Gram否词分析
- [ ] 实现词根拆分（Tokenization）
- [ ] 实现核心词根排除机制
- [ ] 实现频率统计和阈值判定
- [ ] 实现否词建议生成

### 流量迁移算法
- [ ] 实现迁移触发条件检测
- [ ] 实现流量隔离规则
- [ ] 实现冲突消解算法

### 人工审核界面
- [ ] 实现否词建议审核页面
- [ ] 实现迁移建议审核页面
- [ ] 实现一键接受/拒绝功能
- [ ] 实现批量选择操作



## 算法优化（第三十一阶段）

### 分时预算算法升级（周×时段二维控制）
- [ ] 更新算法文档，加入周×时段二维控制（7天×12时段=84个控制单元）
- [ ] 升级hourlyBudgetAlgorithm.ts支持周维度
- [ ] 实现周×时段表现数据收集和分析
- [ ] 支持按周几和时段组合进行预算调整
- [ ] 添加周×时段热力图可视化


## 算法学习期机制（第三十二阶段）

### 学习期方案设计
- [x] 设计学习期阶段划分（冷启动期、学习期、成熟期）
- [x] 定义各阶段的数据充分性判断标准（阈值减半）
- [x] 设计各阶段的保守优化策略
- [x] 设计学习期进度指示器
- [x] 确定调整因子曲线（市场曲线/S曲线）
- [x] 设计特殊情况处理（大促缩短、季节性延长、迁移先冷启动）

### 学习期实现
- [x] 实现数据充分性评估算法
- [x] 实现学习期阶段自动判定
- [x] 实现各阶段差异化的优化参数
- [x] 实现市场曲线（S曲线）调整因子
- [ ] 实现学习期进度UI展示
- [ ] 修复TypeScript类型错误

### TypeScript类型错误修复
- [ ] 修复server/db.ts中的Date类型与string类型不匹配问题
- [ ] 修复server/routers.ts中的剩余类型错误
- [ ] 修复server/optimizationTargetEngine.ts中的类型错误
- [ ] 修复server/amazonSyncService.ts中的类型错误
- [ ] 修复server/intelligentBudgetAllocationService.ts中的类型错误
- [ ] 修复server/aiOptimizationService.ts中的类型错误
- [ ] 修复前端组件中的类型错误（BatchOperations.tsx, BidAdjustmentHistory.tsx等）


## Bug修复（持续进行）

### TypeScript类型错误修复
- [x] 修复PerformanceGroupDetail页面的toFixed错误（kpiSummary数据类型问题）
- [x] 修复routers.ts中的字段名不匹配问题（campaignStatus/status/batchStatus/itemStatus）
- [x] 修复routers.ts中的input.targetStatus应该是input.status
- [x] 修复db.ts中的字段名不匹配问题（logTargetType/curveTargetType等）
- [x] 修复effectTrackingScheduler.ts中的isRolledBack字段不存在问题（改用status字段）
- [x] 修复Dashboard页面bid_adjustment_history查询WHERE子句为空的问题


## TypeScript错误修复（第二十三阶段）

### routers.ts类型错误修复
- [ ] 修复routers.ts中剩余的56个TypeScript错误
- [ ] 修复includeCharts boolean/number类型不匹配
- [ ] 修复其他字段类型不匹配问题

### optimizationTargetEngine.ts类型错误修复
- [ ] 修复optimizationTargetEngine.ts中的28个TypeScript错误
- [ ] 修复日期类型和字段名问题

### 前端组件类型修复
- [ ] 修复BatchOperations.tsx中的18个类型错误
- [ ] 修复PerformanceGroupDetail.tsx中的15个类型错误

### 类型安全数据库查询
- [ ] 创建类型安全的数据库查询helper函数
- [ ] 为常用查询添加类型定义


## SEO优化
- [x] 修复首页SEO问题：添加关键词
- [x] 修复首页SEO问题：添加H1标题
- [x] 修复首页SEO问题：添加H2标题
- [x] 修复首页SEO问题：优化页面标题（30-60字符）
- [x] 修复首页SEO问题：添加描述信息（50-160字符）



## 手动授权功能（紫鸟浏览器兼容）- 第二十三阶段
- [x] 后端：生成亚马逊授权链接API（getManualAuthUrl）
- [x] 后端：手动输入授权码换取Token API（exchangeManualAuthCode）
- [x] 前端：紫鸟浏览器专用授权卡片UI
- [x] 前端：三个市场区域授权链接（NA/EU/FE）
- [x] 前端：URL粘贴和自动提取授权码功能
- [x] 前端：安全说明文案
- [x] 测试完整授权流程


## API安全三件套 - 第二十四阶段

### 详细操作日志记录
- [ ] 设计API操作日志数据库表结构（api_operation_logs）
- [ ] 实现日志记录服务（记录所有API调用详情）
- [ ] 记录操作类型、目标对象、参数、结果、时间戳、IP地址
- [ ] 创建日志查询和导出API
- [ ] 创建操作日志前端页面

### 每日花费限额告警
- [ ] 设计花费限额配置数据库表结构（spend_limit_configs）
- [ ] 实现花费监控服务
- [ ] 实现限额检查逻辑（预算消耗百分比告警）
- [ ] 集成通知服务发送告警
- [ ] 创建限额配置前端界面

### 异常操作自动暂停通知
- [ ] 设计异常检测规则数据库表结构（anomaly_detection_rules）
- [ ] 实现异常检测算法（出价异常、批量操作异常等）
- [ ] 实现自动暂停机制
- [ ] 集成通知服务发送暂停通知
- [ ] 创建异常规则配置前端界面


## TypeScript错误修复 - 第二十五阶段
- [ ] 修复targetType字段类型不匹配问题（keyword/product_target/placement vs keyword/product）
- [ ] 修复BidChangeRecord类型定义冲突
- [ ] 修复其他字段名不匹配问题
- [ ] 统一数据库字段命名规范


## API安全三件套（第二十四阶段）

### 详细操作日志记录
- [x] 设计操作日志数据库表结构
- [x] 实现操作日志记录服务
- [x] 记录所有API调用操作（出价调整、预算变更、状态变更等）
- [x] 支持按账号、操作类型、风险等级筛选

### 每日花费限额告警
- [x] 设计花费限额配置数据库表结构
- [x] 实现花费限额配置API
- [x] 实现花费告警检测逻辑
- [x] 支持多级告警阈值（50%、80%、95%）
- [x] 集成通知服务发送告警

### 异常操作自动暂停通知
- [x] 设计异常检测规则数据库表结构
- [x] 实现异常检测规则配置API
- [x] 实现自动暂停记录API
- [x] 支持多种异常类型检测（出价飙升、批量操作数量、ACoS飙升等）
- [x] 支持自动暂停和手动恢复

### API安全中心前端页面
- [x] 创建API安全中心页面
- [x] 实现操作日志展示Tab
- [x] 实现花费限额配置Tab
- [x] 实现异常检测规则Tab
- [x] 实现自动暂停记录Tab
- [x] 在侧边栏添加API安全中心入口


## Bug修复 - 紫鸟浏览器授权码提取

- [x] 分析紫鸟授权回调URL格式
- [x] 修复授权码换取逻辑（使用后端环境变量）
- [ ] 测试修复后的授权流程

## Bug修复 - 授权成功后自动填充凭证信息

- [ ] 修改后端exchangeCode接口返回Client ID
- [ ] 添加自动获取Profile ID的功能
- [ ] 修改前端自动填充Client ID、Client Secret、Profile ID
- [ ] 测试完整授权流程


## 已完成的Bug修复汇总

### 紫鸟浏览器授权流程修复
- [x] 分析紫鸟授权回调URL格式
- [x] 修复授权码换取逻辑（使用后端环境变量）
- [x] 测试修复后的授权流程 - 用户确认授权成功

### 授权成功后自动填充凭证信息
- [x] 修改后端exchangeCode接口返回Client ID和Client Secret
- [x] 添加自动获取Profile ID的功能
- [x] 修改前端自动填充Client ID、Client Secret、Profile ID
- [x] 测试完整授权流程 - 用户确认授权成功

### 保存凭证后更新连接状态
- [x] 修改saveCredentials接口，保存后自动更新connectionStatus为connected


## 授权后自动同步数据 - 第二十五阶段

- [x] 修改saveCredentials接口，授权成功后自动触发数据同步
- [x] 自动同步广告活动数据
- [x] 自动同步广告组数据
- [x] 自动同步关键词数据
- [x] 自动同步商品定位数据
- [x] 修复Performance group not found错误


## Bug修复 - 授权后自动同步功能

- [ ] 检查saveCredentials接口中的自动同步逻辑
- [ ] 修复自动同步功能未正确触发的问题
- [ ] 确保授权成功后自动更新connectionStatus
- [ ] 测试完整的授权和自动同步流程


## Bug修复 - Profile ID自动获取（第二十六阶段）

- [ ] 检查exchangeCode接口中Profile获取逻辑
- [ ] 修复Profile ID自动获取功能
- [ ] 确保前端正确接收并填充Profile ID
- [ ] 测试完整授权流程


## Bug修复（第四十五阶段）

### 前端凭证显示修复
- [x] 修复OAuth授权成功后前端表单显示占位符而非实际凭证的问题
- [x] 将useEffect钩子移动到credentialsStatus定义之后
- [x] 确保凭证状态加载完成后自动填充表单
- [x] 验证Client ID、Client Secret、Refresh Token、Profile ID正确显示


### 授权流程加载动画优化
- [x] 分析授权流程中需要加载动画的位置
- [x] 为Token换取过程添加加载动画
- [x] 为凭证保存过程添加加载动画
- [x] 为数据同步过程添加加载动画
- [x] 优化加载状态的用户提示文案
- [x] 添加进度条和步骤指示器
- [x] 实现授权完成后自动保存凭证并同步数据


## 授权流程优化（第四十六阶段）

### 授权失败重试机制
- [ ] 添加错误状态管理和错误信息存储
- [ ] 实现一键重试按钮
- [ ] 添加详细的错误诊断信息展示
- [ ] 根据错误类型提供针对性的解决建议

### 数据同步进度展示优化
- [ ] 修改后端同步API返回详细进度信息
- [ ] 前端实时显示同步进度（如"正在同步广告活动 3/10"）
- [ ] 添加各数据类型的同步状态指示

### 授权历史记录功能
- [ ] 创建授权历史记录数据库表
- [ ] 实现授权历史记录API
- [ ] 添加授权历史记录UI展示
- [ ] 记录授权时间、结果、错误信息等


### 问题排查与修复
- [ ] 检查API授权状态
- [ ] 验证广告数据是否正常同步
- [ ] 修复主界面刷新数据按钮无响应问题


## Bug修复（第四十六阶段）

### 主界面刷新数据按钮修复
- [x] 检查API授权状态 - 已确认有效
- [x] 验证广告数据是否正常同步 - 数据库中有8个广告活动
- [x] 修复主界面刷新数据按钮无响应问题
- [x] 添加react-hot-toast替代sonner（解决toast不显示问题）
- [x] 使用状态变量触发toast显示
- [x] 刷新按钮现在显示"开始刷新数据..."和"数据刷新成功!"提示


## Bug修复（第四十七阶段）

### API凭证无效错误修复
- [ ] 诊断API凭证无效的原因
- [ ] 检查凭证验证逻辑
- [ ] 修复凭证验证和同步功能
- [ ] 测试数据同步是否正常工作


## Bug修复（第四十八阶段）

### SB品牌广告和SD展示广告API修复
- [ ] 研究Amazon SB广告API正确的端点和调用方式
- [ ] 研究Amazon SD广告API正确的端点和调用方式
- [ ] 修复SB品牌广告API调用代码
- [ ] 修复SD展示广告API调用代码
- [ ] 测试SB/SD广告数据获取

### Amazon API页面数据同步标签修复
- [ ] 检查数据同步标签是否存在
- [ ] 修复或添加数据同步标签
- [ ] 确保同步按钮功能正常


## Bug修复（第四十八阶段）

### SB品牌广告和SD展示广告API修复
- [x] 修复SB品牌广告API调用问题（需要特定的Content-Type header）
- [x] 修复SD展示广告API调用问题（使用GET方法而非POST）
- [x] 修复SB API分页限制问题（maxResults最大100）
- [x] 确保Amazon API页面有数据同步功能（已存在）

### SQL查询错误修复
- [x] 修复keywords表查询使用错误的列名status（应为keywordStatus）


## 用户体验优化（第四十九阶段）

### 广告活动页面同步按钮优化
- [x] 修改广告活动页面的同步数据按钮，直接在当前页面执行同步
- [x] 移除跳转到Amazon API页面的逻辑
- [x] 添加同步进度和状态反馈


## 用户体验优化（第五十阶段）

### Amazon API站点定义优化
- [x] 在授权界面添加具体站点选择（如美国、加拿大、墨西哥等）
- [x] 显示区域与站点的对应关系说明
- [x] 优化授权链接生成，明确显示授权的具体站点
- [x] 在账号列表中显示具体站点信息


## 用户体验优化（第五十一阶段）

### 账号列表区域/站点筛选功能
- [x] 在账号列表顶部添加区域筛选下拉框（全部/北美/欧洲/远东）
- [x] 添加站点筛选下拉框（根据选择的区域动态显示对应站点）
- [x] 实现筛选逻辑，根据选择过滤账号列表
- [x] 添加快速清除筛选按钮

- [x] 优化账号筛选器：选择区域后自动展开显示该区域下的所有站点


## 数据分析功能（第五十二阶段）

### 仪表盘区域级别数据对比
- [x] 设计区域对比UI组件（卡片式对比视图）
- [x] 实现区域数据汇总后端API
- [x] 添加区域对比图表（柱状图/雷达图）
- [x] 显示各区域关键指标对比（销售额、ACoS、ROAS等）

- [x] 为区域数据对比功能添加自定义时间范围选择器
- [x] 修改后端API支持startDate和endDate参数
- [x] 添加预设时间范围（今天、昨天、最近7天、最近30天、本月、上月、自定义）

- [x] 将区域数据对比模块移到仪表盘界面的头部


## Bug修复（第五十三阶段）

### 重新授权现有账号时的Invalid API credentials错误
- [ ] 分析重新授权流程中的验证逻辑
- [ ] 修复验证逻辑中的问题

- [ ] 检查授权链接生成逻辑
- [ ] 检查授权码换取Token逻辑
- [ ] 检查凭证保存和验证逻辑
- [ ] 测试完整授权流程

- [x] 修复重新授权后凭证状态未正确更新的bug


## 用户体验优化（第五十四阶段）

### 授权流程可视化进度条
- [x] 设计授权进度条UI组件
- [x] 显示步骤：生成链接 → 换取Token → 验证凭证 → 保存凭证 → 同步数据
- [x] 集成到普通授权和紫鸟浏览器授权界面


## 用户体验优化（第五十五阶段）

### 授权失败错误恢复机制
- [ ] 添加授权失败状态显示
- [ ] 显示失败原因和建议操作
- [ ] 添加"重试"按钮，从失败步骤重新开始
- [ ] 添加"重置"按钮，完全重新开始授权流程

### 数据同步进度指示器
- [ ] 添加同步进度状态（SP/SB/SD广告）
- [ ] 显示每种广告类型的同步进度
- [ ] 显示同步的数据数量统计
- [ ] 添加同步完成后的结果汇总


## 授权流程和数据同步优化（第四十阶段）

### 授权失败错误恢复机制
- [x] 为授权流程添加错误状态支持
- [x] 显示错误详情和恢复建议
- [x] 添加"重新开始"按钮允许用户从头重试
- [x] 根据失败步骤提供针对性的恢复指导

### 数据同步进度指示器
- [x] 添加同步进度状态变量（step, progress, current, results）
- [x] 实现分步骤进度显示（SP/SB/SD/广告组/关键词/商品定位）
- [x] 创建可视化进度条和步骤指示器
- [x] 显示每个步骤的完成状态（进行中/已完成）
- [x] 同步完成后显示详细的同步结果统计
- [x] 同步失败时显示错误信息和重试按钮

### 后端同步服务优化
- [x] 更新syncAll方法返回SP/SB/SD分类数量
- [x] 添加syncSbCampaigns方法同步品牌广告
- [x] 添加syncSdCampaigns方法同步展示广告
- [x] 更新API返回格式包含分类统计


## 同步功能优化（第四十一阶段）- 已完成

### 同步历史记录
- [x] 扩展dataSyncJobs表添加增量同步和重试相关字段
- [x] 实现同步历史记录后端API（getSyncHistory, getSyncStats）
- [x] 更新前端界面显示同步历史（统计卡片和历史列表）

### 增量同步
- [x] 实现增量同步逻辑（基于lastSyncTime参数跳过未变化的数据）
- [x] 添加增量同步选项到前端（Switch组件控制）
- [x] 更新所有同步方法支持lastSyncTime参数

### 自动重试
- [x] 实现同步失败自动重试机制（最多3次）
- [x] 添加指数退避延迟（1秒、2秒、4秒）
- [x] 记录重试次数到同步历史

## 同步功能增强（第四十二阶段）

### 同步数据对比功能
- [ ] 设计同步变更记录数据库表结构
- [ ] 实现同步前后数据对比算法
- [ ] 创建数据变更统计API（新增/更新/删除数量）
- [ ] 在前端显示同步变更摘要

### 同步冲突检测功能
- [ ] 设计冲突检测数据库表结构
- [ ] 实现本地数据与API数据一致性检查
- [ ] 创建冲突检测API
- [ ] 在前端显示冲突提醒和解决方案

### 同步任务队列功能
- [ ] 设计任务队列数据库表结构
- [ ] 实现多账号同步任务队列管理
- [ ] 创建队列状态查询API
- [ ] 在前端显示队列进度和预计完成时间

## 同步功能增强（第四十二阶段）- 已完成

### 同步数据对比功能
- [x] 设计同步变更记录表结构
- [x] 实现变更跟踪的同步方法
- [x] 前端显示变更摘要（新增/更新/删除数量）

### 同步冲突检测功能
- [x] 设计同步冲突记录表结构
- [x] 实现冲突检测逻辑
- [x] 前端显示冲突列表和解决选项

### 同步任务队列功能
- [x] 设计同步任务队列表结构
- [x] 实现队列管理API
- [x] 前端显示队列状态和进度

## 定时同步功能（第四十三阶段）

### 定时同步
- [ ] 检查现有定时同步数据库表结构
- [ ] 实现每2小时自动同步调度器
- [ ] 添加定时同步设置API
- [ ] 更新前端界面支持定时同步设置
- [ ] 添加同步日志和状态显示

## 定时同步功能（第四十三阶段）- 已完成

### 定时同步
- [x] 设计定时同步数据库表结构
- [x] 实现定时任务调度器（支持每2小时等多种频率）
- [x] 添加定时同步设置API
- [x] 更新前端界面支持定时同步设置
- [x] 添加同步日志和状态显示

## 系统全面排查（第四十四阶段）

### 数据库检查
- [ ] 检查核心数据库表结构完整性
- [ ] 验证所有表字段与schema定义一致
- [ ] 检查外键关系和索引

### Amazon API模块检查
- [ ] 检查OAuth授权流程
- [ ] 检查API凭证存储
- [ ] 检查API调用功能

### 数据同步模块检查
- [ ] 检查同步任务表结构
- [ ] 检查同步历史记录功能
- [ ] 检查定时同步功能

### 广告管理模块检查
- [ ] 检查广告活动管理
- [ ] 检查广告组管理
- [ ] 检查关键词管理

### 优化引擎模块检查
- [ ] 检查竞价优化功能
- [ ] 检查预算管理功能
- [ ] 检查自动化规则功能

### 测试验证
- [ ] 运行单元测试
- [ ] 验证API端点

### 检查结果（2026-01-07）
- [x] 数据库表结构完整性检查 - 77个表存在
- [x] Amazon API凭证表结构正常（14个字段）
- [x] 广告活动表结构正常（29个字段）
- [x] 广告组表结构正常（13个字段）
- [x] 关键词表结构正常（23个字段）
- [x] 商品定位表结构正常（18个字段）
- [x] 数据同步任务表已修复（添加11个缺失字段）
- [x] 同步冲突表结构正常（17个字段）
- [x] 同步任务队列表结构正常（18个字段）
- [x] 定时同步表结构正常（12个字段）
- [x] 单元测试通过率：652/656（99.4%）
- [x] 4个失败测试为非核心功能（A/B测试和预算自动执行的辅助函数导出问题）

## 重新授权前准备（第四十五阶段）

### 清理旧数据
- [ ] 清空广告活动数据
- [ ] 清空广告组数据
- [ ] 清空关键词数据
- [ ] 清空商品定位数据
- [ ] 清空同步历史数据

### 配置定时同步
- [ ] 设置每2小时自动同步

### 设置预算预警
- [ ] 配置预算阈值
- [ ] 配置预警通知

## 修复类型错误（第四十六阶段）

### 数据库类型修复
- [ ] 修复data_sync_schedules表字段映射
- [ ] 修复其他表字段映射问题

### 代码类型修复
- [ ] 修复BidChangeRecord类型不匹配
- [ ] 修复其他TypeScript类型错误


## TypeScript错误修复（第五十阶段）

### 服务端TypeScript错误修复
- [x] 修复数据库字段名不匹配问题（status → campaignStatus/batchStatus/keywordStatus等）
- [x] 修复Date类型转换问题（Date → string，数据库使用timestamp mode: 'string'）
- [x] 修复boolean到number的转换（tinyint字段需要0/1而非true/false）
- [x] 修复函数参数类型不匹配问题
- [x] 修复缺失的属性和导入问题
- [x] 修复db null检查问题（getDb()可能返回null）

### 前端TypeScript错误修复
- [x] 修复页面组件中的属性名不匹配
- [x] 修复类型转换问题
- [x] 修复可能undefined的属性访问
- [x] 修复导入路径问题

### 验证
- [x] TypeScript编译通过（0错误）
- [x] 开发服务器正常运行
- [x] 页面正常加载


## Bug修复（第五十一阶段）

- [x] 修复 syncService.syncSpCampaignsWithTracking is not a function 错误


## 功能增强（第五十二阶段）

- [ ] 广告活动模块添加店铺筛选功能
- [ ] 广告活动模块添加站点筛选功能
- [ ] 按优先级重新排列筛选项：1.店铺/站点 2.广告类型 3.广告计费方式



## 功能增强（第五十二阶段）

### 广告活动筛选功能优化
- [x] 广告活动模块添加店铺筛选功能
- [x] 广告活动模块添加站点筛选功能
- [x] 按优先级重新排列筛选项：1.店铺/站点 2.广告类型 3.计费方式
- [x] 添加计费方式筛选功能（CPC/vCPM/CPM）
- [x] 添加当前筛选条件摘要显示
- [x] 支持点击筛选标签快速清除单个筛选条件
- [x] 添加"清除全部"筛选按钮


## 自动广告优化增强（第五十三阶段）

### 自动广告匹配类型优化
- [ ] 研究亚马逊广告API文档了解自动广告功能支持
- [ ] 实现紧密匹配（Close Match）优化算法
- [ ] 实现宽泛匹配（Loose Match）优化算法
- [ ] 实现关联商品（Substitutes）优化算法
- [ ] 实现同类商品（Complements）优化算法
- [ ] 支持按匹配类型单独调整竞价

### 竞价位置调整功能
- [ ] 实现搜索顶部（Top of Search）竞价倾斜
- [ ] 实现商品详情页（Product Pages）竞价倾斜
- [ ] 实现其余位置（Rest of Search）竞价倾斜
- [ ] 支持按位置设置竞价百分比调整

### 分时竞价和分时预算功能
- [ ] 实现周天不同时间的竞价调整
- [ ] 实现一天内不同时间段的竞价调整
- [ ] 实现分时预算功能
- [ ] 创建分时策略配置界面


## 广告优化算法完善（第五十三阶段）

### 数据库更新
- [ ] 推送自动广告优化相关表结构

### SB品牌广告优化
- [ ] 研究SB广告API文档
- [ ] 设计品牌广告竞价优化算法
- [ ] 实现品牌广告关键词优化
- [ ] 实现品牌广告创意优化建议

### SD展示广告优化
- [ ] 研究SD广告API文档
- [ ] 设计展示广告受众定向优化算法
- [ ] 实现展示广告竞价优化
- [ ] 实现展示广告位置优化

### 搜索词分析优化
- [ ] 设计搜索词分类算法
- [ ] 实现搜索词转关键词建议
- [ ] 实现搜索词否定建议
- [ ] 实现搜索词绩效跟踪

### 自动广告匹配类型优化
- [ ] 实现紧密匹配优化算法
- [ ] 实现宽泛匹配优化算法
- [ ] 实现关联商品优化算法
- [ ] 实现同类商品优化算法

### 文档整理
- [ ] 整理完整的广告优化算法文档


## SB/SD广告优化算法和搜索词分析（第四十五阶段）

### SP自动广告四种匹配类型优化
- [x] 创建autoTargetingOptimizationService.ts服务
- [x] 实现四种匹配类型绩效分析（紧密匹配、宽泛匹配、同类商品、关联商品）
- [x] 实现匹配类型优化建议生成算法
- [x] 支持暂停、启用、调整竞价等操作建议

### SB品牌广告优化算法
- [x] 创建sbOptimizationService.ts服务
- [x] 支持三种品牌广告类型（商品集合、品牌旗舰店聚焦、视频广告）
- [x] 实现品牌广告绩效分析算法
- [x] 生成竞价优化、创意优化、定向扩展、预算重分配建议
- [x] 实现关键词级别优化建议生成
- [x] 支持新客户指标分析

### SD展示广告优化算法
- [x] 创建sdOptimizationService.ts服务
- [x] 支持六种受众定向类型（浏览再营销、购买再营销、相似商品、类目定向、ASIN定向、兴趣定向）
- [x] 实现展示广告绩效分析算法
- [x] 支持浏览归因销售额计算
- [x] 生成受众优化、创意优化、计费方式切换建议
- [x] 实现受众级别优化建议生成

### 搜索词分析与优化算法
- [x] 创建searchTermAnalysisService.ts服务
- [x] 实现搜索词分类算法（高价值词、潜力词、低效词、品牌词等）
- [x] 实现N-Gram词根分析（单词、双词组合、三词组合）
- [x] 实现否定词根识别算法
- [x] 生成搜索词优化建议（添加关键词、添加否定词、迁移到手动广告）
- [x] 实现搜索词迁移计划生成

### 优化算法文档
- [x] 创建完整的优化算法文档（docs/optimization-algorithms-guide.md）
- [x] 文档包含SP/SB/SD三种广告类型的优化策略
- [x] 文档包含市场曲线建模算法说明
- [x] 文档包含安全边界和风控机制说明


## SB/SD广告优化前端界面和系统集成（第四十六阶段）

### SB品牌广告优化前端页面
- [ ] 创建SBOptimization.tsx页面组件
- [ ] 显示品牌广告活动列表和绩效数据
- [ ] 展示优化建议卡片（竞价、创意、定向、预算）
- [ ] 实现一键应用优化建议功能
- [ ] 显示新客户指标分析

### SD展示广告优化前端页面
- [ ] 创建SDOptimization.tsx页面组件
- [ ] 显示展示广告活动列表和绩效数据
- [ ] 展示受众定向优化建议
- [ ] 显示浏览归因销售额分析
- [ ] 实现一键应用优化建议功能

### 搜索词分析前端页面
- [ ] 创建SearchTermAnalysis.tsx页面组件
- [ ] 显示搜索词分类列表（高价值词、潜力词、低效词）
- [ ] 展示N-Gram词根分析结果
- [ ] 显示否定词根建议
- [ ] 实现批量添加否定词功能
- [ ] 实现搜索词迁移功能

### 后端API路由支持
- [ ] 添加SB广告优化相关API路由
- [ ] 添加SD广告优化相关API路由
- [ ] 添加搜索词分析相关API路由

### 定时任务集成
- [ ] 将SB广告优化算法集成到定时任务
- [ ] 将SD广告优化算法集成到定时任务
- [ ] 将搜索词分析算法集成到定时任务
- [ ] 添加自动执行配置选项

### 优化中心广告类型筛选
- [ ] 在优化中心页面添加广告类型筛选标签
- [ ] 支持按SP/SB/SD类型筛选优化建议
- [ ] 保持筛选状态

### 侧边栏导航更新
- [ ] 在优化引擎菜单下添加SB广告优化入口
- [ ] 在优化引擎菜单下添加SD广告优化入口
- [ ] 在优化引擎菜单下添加搜索词分析入口


## SB/SD广告优化前端界面和系统集成（第四十六阶段）

### SB品牌广告优化前端页面
- [ ] 创建SBOptimization.tsx页面组件
- [ ] 显示品牌广告活动列表和绩效数据
- [ ] 展示优化建议卡片（竞价、创意、定向、预算）
- [ ] 实现一键应用优化建议功能
- [ ] 显示新客户指标分析

### SD展示广告优化前端页面
- [ ] 创建SDOptimization.tsx页面组件
- [ ] 显示展示广告活动列表和绩效数据
- [ ] 展示受众定向优化建议
- [ ] 显示浏览归因销售额分析
- [ ] 实现一键应用优化建议功能

### 搜索词分析前端页面
- [ ] 创建SearchTermAnalysis.tsx页面组件
- [ ] 显示搜索词分类列表（高价值词、潜力词、低效词）
- [ ] 展示N-Gram词根分析结果
- [ ] 显示否定词根建议
- [ ] 实现批量添加否定词功能
- [ ] 实现搜索词迁移功能

### 后端API路由支持
- [ ] 添加SB广告优化相关API路由
- [ ] 添加SD广告优化相关API路由
- [ ] 添加搜索词分析相关API路由

### 定时任务集成
- [ ] 将SB广告优化算法集成到定时任务
- [ ] 将SD广告优化算法集成到定时任务
- [ ] 将搜索词分析算法集成到定时任务
- [ ] 添加自动执行配置选项

### 优化中心广告类型筛选
- [ ] 在优化中心页面添加广告类型筛选标签
- [ ] 支持按SP/SB/SD类型筛选优化建议
- [ ] 保持筛选状态

### 侧边栏导航更新
- [ ] 在优化引擎菜单下添加SB广告优化入口
- [ ] 在优化引擎菜单下添加SD广告优化入口
- [ ] 在优化引擎菜单下添加搜索词分析入口


## 搜索广告优化算法升级（第四十七阶段）

### 算法框架设计
- [ ] 分析SP广告和SB视频广告的搜索特性
- [ ] 设计统一的搜索广告优化引擎架构
- [ ] 定义市场曲线建模在搜索广告中的应用方式

### SP商品推广广告完整算法
- [ ] 市场曲线建模（展现曲线、点击率曲线、利润曲线）
- [ ] 边际分析算法（边际利润计算、最优竞价点搜索）
- [ ] 决策树逻辑（多条件判断、优先级排序）
- [ ] 关键词级别优化
- [ ] 广告位置竞价优化
- [ ] 分时竞价优化

### SB视频广告搜索优化算法
- [ ] 视频广告关键词市场曲线建模
- [ ] 视频广告边际分析（考虑视频观看率因素）
- [ ] 视频广告决策树逻辑
- [ ] 视频广告与SP广告的协同优化

### 统一搜索广告优化引擎
- [ ] 创建searchAdsOptimizationEngine.ts
- [ ] 实现市场曲线拟合算法
- [ ] 实现边际利润计算
- [ ] 实现决策树执行引擎
- [ ] 支持SP和SB视频广告

### 算法文档整理
- [ ] 编写完整的搜索广告优化算法文档
- [ ] 包含数学公式和算法流程图
- [ ] 包含决策树规则说明


## 分渠道优化功能完整映射（第四十八阶段）

### 优化功能矩阵设计
- [ ] 梳理所有优化功能：分时预算、分时竞价、位置倾斜、竞价调整、搜索词、搜索ASIN、迁移、否定、暂停
- [ ] 研究每种广告类型（SP自动/手动、SB商品集合/旗舰店/视频、SD受众/商品）支持的功能
- [ ] 创建完整的功能支持矩阵表

### 算法设计更新
- [ ] 更新SP广告优化算法（包含所有支持的功能）
- [ ] 更新SB广告优化算法（区分视频广告的搜索特性）
- [ ] 更新SD广告优化算法（考虑展示广告特性）
- [ ] 设计功能适配层（根据广告类型自动选择可用功能）

### 代码实现
- [ ] 实现分渠道优化引擎
- [ ] 实现功能适配器
- [ ] 编写单元测试


## 以产品为中心的全局优化算法（第四十九阶段）

### 架构设计
- [ ] 设计产品维度的广告矩阵数据结构
- [ ] 设计跨渠道数据聚合模型
- [ ] 设计全局优化决策引擎架构

### 搜索词全局分析
- [ ] 实现跨渠道搜索词聚合（SP自动+SP手动关键词+SB视频）
- [ ] 实现N-Gram全局降噪算法
- [ ] 实现跨渠道否定词同步机制
- [ ] 实现产品属性匹配度分析

### 预算与竞价全局优化
- [ ] 实现跨渠道边际ROAS计算
- [ ] 实现全局预算分配算法
- [ ] 实现跨渠道竞价协调（避免自我竞争）
- [ ] 实现全局最优解求解器

### 文档与测试
- [ ] 编写完整的全局优化算法文档
- [ ] 编写单元测试


## 双层N-Gram分析算法设计（第五十阶段）

### 算法架构
- [x] 设计双层N-Gram分析架构（商品级+品牌级）
- [x] 更新全局优化算法文档
- [x] 整理完整的算法功能清单和优势说明



## 新品推广期优化算法设计（第五十一阶段）

### 算法设计
- [x] 分析新品推广期的特殊挑战和需求
- [x] 设计新品冷启动优化策略
- [x] 设计新品数据积累期算法
- [x] 设计新品成长期过渡算法
- [x] 更新算法功能清单文档



## 新广告活动冷启动优化算法（第五十二阶段）

### 算法设计
- [x] 分析新广告活动的数据缺失场景
- [x] 设计数据继承和迁移策略
- [x] 设计零数据冷启动算法
- [x] 设计学习期保护和加速机制
- [x] 更新算法文档



## 广告优化算法完整复盘（第五十三阶段）

### 复盘任务
- [x] 梳理已覆盖的算法场景
- [x] 挖掘尚未提到的特殊情况
- [x] 补充遗漏的算法设计
- [x] 更新完整的算法文档



## 特殊场景算法优化（第五十四阶段）

### 基于API数据能力的特殊场景算法
- [x] 预算耗尽智能预测与动态调整算法
- [x] 归因窗口数据延迟智能调整算法
- [x] 竞价效率分析与过度竞价检测算法
- [x] 季节性智能调整算法
- [x] 大促前后渐进式调整计划生成
- [x] 综合特殊场景分析接口
- [x] 单元测试覆盖
- [x] API路由集成



## 特殊场景分析功能完善（第五十五阶段）

### 特殊场景分析入口
- [x] 在优化中心添加"特殊场景分析"入口卡片
- [x] 创建特殊场景分析页面
- [x] 展示预算耗尽风险分析结果
- [x] 展示归因调整数据对比
- [x] 展示竞价效率分析结果
- [x] 展示季节性调整建议
- [x] 展示关键风险提示摘要

### 归因调整数据应用
- [x] 在仪表盘中显示归因调整后的数据
- [x] 添加原始数据与调整数据的切换开关
- [x] 在报表中标注数据置信度

### 竞价效率批量优化
- [x] 创建竞价效率分析结果列表
- [x] 实现批量选择过度竞价的投放词
- [x] 实现一键应用建议出价功能
- [x] 添加批量操作确认弹窗
- [x] 记录批量操作历史



## 系统自动化执行优化（第五十六阶段）

### 分析与设计
- [x] 梳理现有系统中所有人为操作入口
- [x] 识别可由系统自动完成的工作流程
- [x] 设计自动化执行方案

### 自动化执行实现
- [x] 实现优化建议自动执行（无需人工确认）
- [x] 实现竞价调整自动应用
- [x] 实现预算调整自动执行
- [x] 实现异常情况自动回滚
- [x] 实现定时任务自动触发

### 风险控制
- [x] 实现自动执行的安全边界
- [x] 实现操作限额和频率控制
- [x] 实现自动监控和告警
- [x] 实现操作审计日志



## 流量隔离与N-Gram降噪算法优化（第五十七阶段）

### N-Gram词根分析
- [ ] 实现搜索词分词（Tokenization）功能
- [ ] 实现N-Gram词频统计算法
- [ ] 识别高频无效词根（如cheap、plastic、used等）
- [ ] 生成批量否定词建议（短语否定）
- [ ] 实现词根黑名单管理

### 流量隔离体系
- [ ] 实现广告活动匹配类型识别（Broad/Phrase/Exact）
- [ ] 实现搜索词重叠检测算法
- [ ] 实现流量归属决策（基于CVR/AOV）
- [ ] 生成否定词隔离建议（Negative Exact）
- [ ] 实现跨广告活动否定词同步

### 漏斗模型优化
- [ ] 实现三层漏斗架构（精准层/长尾层/探索层）
- [ ] 实现层级过滤逻辑
- [ ] 自动识别已知词和未知词
- [ ] 实现Exact First策略（精准前置）
- [ ] 实现探索层动态竞价建议（Down Only）

### 智能否定词管理
- [ ] 实现否定词自动推荐
- [ ] 实现否定词批量添加
- [ ] 实现否定词效果追踪
- [ ] 实现否定词冲突检测

